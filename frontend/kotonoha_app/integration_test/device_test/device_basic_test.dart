/// å®Ÿæ©ŸåŸºæœ¬å‹•ä½œãƒ†ã‚¹ãƒˆ
///
/// TASK-0095: å®Ÿæ©Ÿãƒ†ã‚¹ãƒˆï¼ˆiOS/Android/ã‚¿ãƒ–ãƒ¬ãƒƒãƒˆï¼‰
/// ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: ğŸ”µ é’ä¿¡å·ï¼ˆNFR-401ã«åŸºã¥ãã€RT-001ã€œRT-016ï¼‰
///
/// iOS/Androidå®Ÿæ©Ÿã§ã®åŸºæœ¬æ©Ÿèƒ½å‹•ä½œã‚’æ¤œè¨¼ã™ã‚‹E2Eãƒ†ã‚¹ãƒˆã€‚
/// æ–‡å­—ç›¤å…¥åŠ›ã€TTSèª­ã¿ä¸Šã’ã€å®šå‹æ–‡ã€å±¥æ­´ã€ãŠæ°—ã«å…¥ã‚Šã€AIå¤‰æ›ãªã©ã®
/// ä¸»è¦æ©Ÿèƒ½ãŒå®Ÿæ©Ÿã§æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚
@Tags(['e2e', 'device', 'ios', 'android'])
library;

import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:integration_test/integration_test.dart';

import '../helpers/test_helpers.dart';

void main() {
  final binding = IntegrationTestWidgetsFlutterBinding.ensureInitialized();

  group('å®Ÿæ©ŸåŸºæœ¬å‹•ä½œãƒ†ã‚¹ãƒˆï¼ˆiOS/Androidå…±é€šï¼‰', () {
    // ============================================================
    // RT-001: ã‚¢ãƒ—ãƒªèµ·å‹•ãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-001: ã‚¢ãƒ—ãƒªãŒæ­£å¸¸ã«èµ·å‹•ã—æ–‡å­—ç›¤ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: iOS/Androidå®Ÿæ©Ÿã§ã‚¢ãƒ—ãƒªãŒæ­£å¸¸ã«èµ·å‹•ã™ã‚‹ã“ã¨ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: NFR-401ï¼ˆiOS 14.0+ã€Android 10+ï¼‰
        // ã€æ‰‹é †ã€‘: ãƒ›ãƒ¼ãƒ ç”»é¢ã‹ã‚‰ã‚¢ãƒ—ãƒªã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¿ãƒƒãƒ—
        // ã€æœŸå¾…çµæœã€‘: ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã—ã€æ–‡å­—ç›¤ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        // ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æº–å‚™ã€‘: ã‚¢ãƒ—ãƒªã‚’åˆæœŸåŒ–
        await pumpApp(tester);

        // ã€çµæœæ¤œè¨¼ã€‘: æ–‡å­—ç›¤ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
        expect(find.text('ã‚'), findsWidgets);
        expect(find.text('ã‹'), findsWidgets);
        expect(find.text('ã•'), findsWidgets);
        // ã€ç¢ºèªå†…å®¹ã€‘: æ–‡å­—ç›¤ã®ä¸»è¦ãªæ–‡å­—ãŒè¡¨ç¤ºã•ã‚Œã‚‹ ğŸ”µ

        // ã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆã€‘: èµ·å‹•ç”»é¢
        await takeScreenshot(binding, 'RT-001_app_startup');
      },
    );

    // ============================================================
    // RT-002: æ–‡å­—ç›¤ã‚¿ãƒƒãƒ—å…¥åŠ›ãƒ†ã‚¹ãƒˆï¼ˆNFR-003: 100msä»¥å†…ï¼‰
    // ============================================================
    testWidgets(
      'RT-002: æ–‡å­—ç›¤ã‚¿ãƒƒãƒ—ãŒ100msä»¥å†…ã«åå¿œã™ã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: æ–‡å­—ç›¤ã‚¿ãƒƒãƒ—ã®å¿œç­”æ€§èƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: NFR-003ï¼ˆæ–‡å­—ç›¤ã‚¿ãƒƒãƒ—å¿œç­”100msä»¥å†…ï¼‰
        // ã€æ‰‹é †ã€‘: ã€Œã‚ã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
        // ã€æœŸå¾…çµæœã€‘: å…¥åŠ›æ¬„ã«ã€Œã‚ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã€100msä»¥å†…
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ã€‘: æ–‡å­—ç›¤ã‚¿ãƒƒãƒ—å¿œç­”æ™‚é–“
        await measurePerformance(
          'æ–‡å­—ç›¤ã‚¿ãƒƒãƒ—å¿œç­”ï¼ˆã‚ï¼‰',
          maxMilliseconds: 100,
          action: () async {
            await tapCharacterOnBoard(tester, 'ã‚');
          },
        );

        // ã€çµæœæ¤œè¨¼ã€‘: å…¥åŠ›æ¬„ã«ã€Œã‚ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹
        expect(find.text('ã‚'), findsWidgets);
        // ã€ç¢ºèªå†…å®¹ã€‘: ã‚¿ãƒƒãƒ—ãŒ100msä»¥å†…ã«åå¿œã—ã€æ–‡å­—ãŒå…¥åŠ›ã•ã‚Œã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-002_character_tap_response');
      },
    );

    // ============================================================
    // RT-003: TTSèª­ã¿ä¸Šã’ãƒ†ã‚¹ãƒˆï¼ˆNFR-001: 1ç§’ä»¥å†…ï¼‰
    // ============================================================
    testWidgets(
      'RT-003: TTSèª­ã¿ä¸Šã’ãŒ1ç§’ä»¥å†…ã«é–‹å§‹ã•ã‚Œã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: TTSèª­ã¿ä¸Šã’é–‹å§‹æ™‚é–“ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: NFR-001ï¼ˆTTSèª­ã¿ä¸Šã’é–‹å§‹1ç§’ä»¥å†…ï¼‰ã€REQ-401
        // ã€æ‰‹é †ã€‘: ã€Œã“ã‚“ã«ã¡ã¯ã€ã¨å…¥åŠ›ã—ã€èª­ã¿ä¸Šã’ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—
        // ã€æœŸå¾…çµæœã€‘: 1ç§’ä»¥å†…ã«èª­ã¿ä¸Šã’ãŒé–‹å§‹ã•ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: æ–‡å­—åˆ—å…¥åŠ›
        await typeOnCharacterBoard(tester, 'ã“ã‚“ã«ã¡ã¯');

        // ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬ã€‘: TTSèª­ã¿ä¸Šã’é–‹å§‹æ™‚é–“
        final stopwatch = Stopwatch()..start();
        await tapIconButton(tester, Icons.volume_up);
        stopwatch.stop();

        final elapsed = stopwatch.elapsedMilliseconds;
        debugPrint('TTSèª­ã¿ä¸Šã’é–‹å§‹æ™‚é–“: ${elapsed}ms');

        // ã€çµæœæ¤œè¨¼ã€‘: 1ç§’ä»¥å†…ã«èª­ã¿ä¸Šã’ãŒé–‹å§‹ã•ã‚Œã‚‹
        // Note: å®Ÿæ©Ÿã§ã¯å®Ÿéš›ã®TTSéŸ³å£°ãŒå†ç”Ÿã•ã‚Œã‚‹ã“ã¨ã‚’æ‰‹å‹•ç¢ºèª
        expect(
          elapsed,
          lessThan(1000),
          reason: 'TTSèª­ã¿ä¸Šã’é–‹å§‹ãŒ1ç§’ã‚’è¶…ãˆã¾ã—ãŸï¼ˆ${elapsed}msï¼‰',
        );
        // ã€ç¢ºèªå†…å®¹ã€‘: TTSèª­ã¿ä¸Šã’ãŒ1ç§’ä»¥å†…ã«é–‹å§‹ã•ã‚Œã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-003_tts_started');
      },
    );

    // ============================================================
    // RT-004: TTSé€Ÿåº¦å¤‰æ›´ãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-004: TTSèª­ã¿ä¸Šã’é€Ÿåº¦ã‚’å¤‰æ›´ã§ãã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: TTSé€Ÿåº¦å¤‰æ›´æ©Ÿèƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: REQ-404ï¼ˆTTSé€Ÿåº¦å¤‰æ›´ï¼‰
        // ã€æ‰‹é †ã€‘: è¨­å®šã§é€Ÿåº¦ã€Œé…ã„ã€â†’ã€Œé€Ÿã„ã€ã«å¤‰æ›´
        // ã€æœŸå¾…çµæœã€‘: èª­ã¿ä¸Šã’é€Ÿåº¦ãŒå¤‰æ›´ã•ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: è¨­å®šç”»é¢ã«é·ç§»
        await tapIconButton(tester, Icons.settings);
        expect(find.text('è¨­å®š'), findsOneWidget);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: TTSé€Ÿåº¦ã‚’ã€Œé…ã„ã€ã«å¤‰æ›´
        final slowSpeedFinder = find.text('é…ã„');
        if (slowSpeedFinder.evaluate().isNotEmpty) {
          await tester.tap(slowSpeedFinder);
          await tester.pumpAndSettle();
        }

        // ã€çµæœæ¤œè¨¼ã€‘: ã€Œé…ã„ã€ãŒé¸æŠã•ã‚Œã¦ã„ã‚‹
        expect(find.text('é…ã„'), findsOneWidget);
        // ã€ç¢ºèªå†…å®¹ã€‘: TTSé€Ÿåº¦è¨­å®šãŒå¤‰æ›´ã•ã‚Œã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-004_tts_speed_slow');

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: TTSé€Ÿåº¦ã‚’ã€Œé€Ÿã„ã€ã«å¤‰æ›´
        final fastSpeedFinder = find.text('é€Ÿã„');
        if (fastSpeedFinder.evaluate().isNotEmpty) {
          await tester.tap(fastSpeedFinder);
          await tester.pumpAndSettle();
        }

        expect(find.text('é€Ÿã„'), findsOneWidget);
        await takeScreenshot(binding, 'RT-004_tts_speed_fast');
      },
    );

    // ============================================================
    // RT-005: TTSåœæ­¢ãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-005: èª­ã¿ä¸Šã’ä¸­ã«åœæ­¢ãƒœã‚¿ãƒ³ã§å³åº§ã«åœæ­¢ã™ã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: TTSåœæ­¢æ©Ÿèƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: REQ-403ï¼ˆTTSåœæ­¢ãƒ»ä¸­æ–­ï¼‰
        // ã€æ‰‹é †ã€‘: èª­ã¿ä¸Šã’ä¸­ã«åœæ­¢ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—
        // ã€æœŸå¾…çµæœã€‘: èª­ã¿ä¸Šã’ãŒå³åº§ã«åœæ­¢ã™ã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: é•·æ–‡ã‚’å…¥åŠ›
        await typeOnCharacterBoard(tester, 'ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆã§ã™ã€‚é•·ã„æ–‡ç« ã‚’å…¥åŠ›ã—ã¦èª­ã¿ä¸Šã’ã‚’ç¢ºèªã—ã¾ã™ã€‚');

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: èª­ã¿ä¸Šã’ã‚’é–‹å§‹
        await tapIconButton(tester, Icons.volume_up);
        await tester.pump(const Duration(milliseconds: 500));

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: åœæ­¢ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
        final stopButton = find.byIcon(Icons.stop);
        if (stopButton.evaluate().isNotEmpty) {
          await tester.tap(stopButton);
          await tester.pumpAndSettle();
        }

        // ã€çµæœæ¤œè¨¼ã€‘: åœæ­¢ãƒœã‚¿ãƒ³ãŒæ©Ÿèƒ½ã™ã‚‹
        // Note: å®Ÿæ©Ÿã§ã¯éŸ³å£°ãŒå®Ÿéš›ã«åœæ­¢ã™ã‚‹ã“ã¨ã‚’æ‰‹å‹•ç¢ºèª
        // ã€ç¢ºèªå†…å®¹ã€‘: TTSèª­ã¿ä¸Šã’ãŒå³åº§ã«åœæ­¢ã™ã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-005_tts_stopped');
      },
    );

    // ============================================================
    // RT-006: å®šå‹æ–‡é¸æŠãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-006: å®šå‹æ–‡ã€Œã‚ã‚ŠãŒã¨ã†ã€ã‚’ã‚¿ãƒƒãƒ—ã—ã¦å³åº§ã«èª­ã¿ä¸Šã’ã‚‰ã‚Œã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: å®šå‹æ–‡æ©Ÿèƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: REQ-101ã€œREQ-107ï¼ˆå®šå‹æ–‡æ©Ÿèƒ½ï¼‰
        // ã€æ‰‹é †ã€‘: å®šå‹æ–‡ã€Œã‚ã‚ŠãŒã¨ã†ã€ã‚¿ãƒƒãƒ—
        // ã€æœŸå¾…çµæœã€‘: å³åº§ã«ã€Œã‚ã‚ŠãŒã¨ã†ã€ãŒèª­ã¿ä¸Šã’ã‚‰ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: å®šå‹æ–‡ç”»é¢ã«é·ç§»
        // Note: å®šå‹æ–‡ã¯æ–‡å­—ç›¤ç”»é¢ã«è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆãŒã‚ã‚‹
        final presetFinder = find.text('ã‚ã‚ŠãŒã¨ã†');
        if (presetFinder.evaluate().isEmpty) {
          // å®šå‹æ–‡ã‚¿ãƒ–ã«é·ç§»
          final presetTabFinder = find.text('å®šå‹æ–‡');
          if (presetTabFinder.evaluate().isNotEmpty) {
            await tester.tap(presetTabFinder);
            await tester.pumpAndSettle();
          }
        }

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ã€Œã‚ã‚ŠãŒã¨ã†ã€ã‚’ã‚¿ãƒƒãƒ—
        final thankYouFinder = find.text('ã‚ã‚ŠãŒã¨ã†');
        if (thankYouFinder.evaluate().isNotEmpty) {
          await tester.tap(thankYouFinder.first);
          await tester.pumpAndSettle();
        }

        // ã€çµæœæ¤œè¨¼ã€‘: å®šå‹æ–‡ãŒé¸æŠã•ã‚Œã‚‹
        // Note: å®Ÿæ©Ÿã§ã¯ã€Œã‚ã‚ŠãŒã¨ã†ã€ãŒå®Ÿéš›ã«èª­ã¿ä¸Šã’ã‚‰ã‚Œã‚‹ã“ã¨ã‚’æ‰‹å‹•ç¢ºèª
        // ã€ç¢ºèªå†…å®¹ã€‘: å®šå‹æ–‡ãŒå³åº§ã«èª­ã¿ä¸Šã’ã‚‰ã‚Œã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-006_preset_phrase_thankyou');
      },
    );

    // ============================================================
    // RT-007: å¤§ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—ãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-007: å¤§ãƒœã‚¿ãƒ³ã€Œã¯ã„ã€ã‚’ã‚¿ãƒƒãƒ—ã—ã¦å³åº§ã«èª­ã¿ä¸Šã’ã‚‰ã‚Œã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: å¤§ãƒœã‚¿ãƒ³æ©Ÿèƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: REQ-201ã€œREQ-208ï¼ˆå¤§ãƒœã‚¿ãƒ³ãƒ»çŠ¶æ…‹ãƒœã‚¿ãƒ³ï¼‰
        // ã€æ‰‹é †ã€‘: ã€Œã¯ã„ã€ãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—
        // ã€æœŸå¾…çµæœã€‘: ã€Œã¯ã„ã€ãŒå³åº§ã«èª­ã¿ä¸Šã’ã‚‰ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ã€Œã¯ã„ã€ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
        final yesFinder = find.text('ã¯ã„');
        if (yesFinder.evaluate().isNotEmpty) {
          await tester.tap(yesFinder.first);
          await tester.pumpAndSettle();
        }

        // ã€çµæœæ¤œè¨¼ã€‘: å¤§ãƒœã‚¿ãƒ³ãŒæ©Ÿèƒ½ã™ã‚‹
        // Note: å®Ÿæ©Ÿã§ã¯ã€Œã¯ã„ã€ãŒå®Ÿéš›ã«èª­ã¿ä¸Šã’ã‚‰ã‚Œã‚‹ã“ã¨ã‚’æ‰‹å‹•ç¢ºèª
        // ã€ç¢ºèªå†…å®¹ã€‘: å¤§ãƒœã‚¿ãƒ³ãŒå³åº§ã«èª­ã¿ä¸Šã’ã‚‰ã‚Œã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-007_large_button_yes');
      },
    );

    // ============================================================
    // RT-008: ç·Šæ€¥ãƒœã‚¿ãƒ³ãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-008: ç·Šæ€¥ãƒœã‚¿ãƒ³ã§ç·Šæ€¥éŸ³ãŒé³´ã‚Šç”»é¢ãŒèµ¤è¡¨ç¤ºã•ã‚Œã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ç·Šæ€¥ãƒœã‚¿ãƒ³æ©Ÿèƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: REQ-301ã€œREQ-307ï¼ˆç·Šæ€¥ãƒœã‚¿ãƒ³ï¼‰
        // ã€æ‰‹é †ã€‘: ç·Šæ€¥ãƒœã‚¿ãƒ³ã‚’2å›ã‚¿ãƒƒãƒ—ï¼ˆç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°â†’ã€Œã¯ã„ã€ï¼‰
        // ã€æœŸå¾…çµæœã€‘: ç·Šæ€¥éŸ³ãŒé³´ã‚Šã€ç”»é¢ãŒèµ¤è¡¨ç¤ºã•ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ç·Šæ€¥ãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
        final emergencyFinder = find.text('ç·Šæ€¥');
        if (emergencyFinder.evaluate().isNotEmpty) {
          await tester.tap(emergencyFinder);
          await tester.pumpAndSettle();

          // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã€Œã¯ã„ã€ã‚’ã‚¿ãƒƒãƒ—
          final confirmYesFinder = find.text('ã¯ã„');
          if (confirmYesFinder.evaluate().isNotEmpty) {
            await tester.tap(confirmYesFinder);
            await tester.pumpAndSettle();
          }
        }

        // ã€çµæœæ¤œè¨¼ã€‘: ç·Šæ€¥ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹
        // Note: å®Ÿæ©Ÿã§ã¯ç·Šæ€¥éŸ³ãŒå®Ÿéš›ã«é³´ã‚‹ã“ã¨ã‚’æ‰‹å‹•ç¢ºèª
        // ã€ç¢ºèªå†…å®¹ã€‘: ç·Šæ€¥éŸ³ãŒé³´ã‚Šã€ç”»é¢ãŒèµ¤è¡¨ç¤ºã•ã‚Œã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-008_emergency_activated');

        // ã€ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã€‘: ç·Šæ€¥ç”»é¢ã‚’é–‰ã˜ã‚‹
        final closeFinder = find.text('é–‰ã˜ã‚‹');
        if (closeFinder.evaluate().isNotEmpty) {
          await tester.tap(closeFinder);
          await tester.pumpAndSettle();
        }
      },
    );

    // ============================================================
    // RT-009: å±¥æ­´ä¿å­˜ãƒ»å†ç”Ÿãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-009: èª­ã¿ä¸Šã’å®Ÿè¡Œå¾Œã«å±¥æ­´ãŒä¿å­˜ã•ã‚Œå†èª­ã¿ä¸Šã’ã§ãã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: å±¥æ­´æ©Ÿèƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: REQ-601ã€œREQ-605ï¼ˆå±¥æ­´æ©Ÿèƒ½ï¼‰
        // ã€æ‰‹é †ã€‘: èª­ã¿ä¸Šã’å®Ÿè¡Œâ†’å±¥æ­´ç”»é¢â†’å±¥æ­´ã‚¿ãƒƒãƒ—
        // ã€æœŸå¾…çµæœã€‘: å±¥æ­´ãŒä¿å­˜ã•ã‚Œã€å†èª­ã¿ä¸Šã’ã•ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: æ–‡å­—åˆ—ã‚’å…¥åŠ›ã—ã¦èª­ã¿ä¸Šã’
        await typeOnCharacterBoard(tester, 'ãƒ†ã‚¹ãƒˆå±¥æ­´');
        await tapIconButton(tester, Icons.volume_up);
        await tester.pump(const Duration(seconds: 1));

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: å±¥æ­´ç”»é¢ã«é·ç§»
        final historyTabFinder = find.text('å±¥æ­´');
        if (historyTabFinder.evaluate().isNotEmpty) {
          await tester.tap(historyTabFinder);
          await tester.pumpAndSettle();
        }

        // ã€çµæœæ¤œè¨¼ã€‘: å±¥æ­´ã«ã€Œãƒ†ã‚¹ãƒˆå±¥æ­´ã€ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹
        expect(find.text('ãƒ†ã‚¹ãƒˆå±¥æ­´'), findsWidgets);
        // ã€ç¢ºèªå†…å®¹ã€‘: å±¥æ­´ãŒä¿å­˜ã•ã‚Œã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-009_history_saved');

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: å±¥æ­´ã‚’ã‚¿ãƒƒãƒ—ã—ã¦å†èª­ã¿ä¸Šã’
        final historyItemFinder = find.text('ãƒ†ã‚¹ãƒˆå±¥æ­´');
        if (historyItemFinder.evaluate().isNotEmpty) {
          await tester.tap(historyItemFinder.first);
          await tester.pumpAndSettle();
        }

        // ã€çµæœæ¤œè¨¼ã€‘: å†èª­ã¿ä¸Šã’ãŒå®Ÿè¡Œã•ã‚Œã‚‹
        // Note: å®Ÿæ©Ÿã§ã¯ã€Œãƒ†ã‚¹ãƒˆå±¥æ­´ã€ãŒå®Ÿéš›ã«èª­ã¿ä¸Šã’ã‚‰ã‚Œã‚‹ã“ã¨ã‚’æ‰‹å‹•ç¢ºèª
        // ã€ç¢ºèªå†…å®¹ã€‘: å±¥æ­´ã‹ã‚‰å†èª­ã¿ä¸Šã’ã•ã‚Œã‚‹ ğŸ”µ
      },
    );

    // ============================================================
    // RT-010: ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-010: å±¥æ­´ã‹ã‚‰ãŠæ°—ã«å…¥ã‚Šç™»éŒ²ã§ãã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ãŠæ°—ã«å…¥ã‚Šæ©Ÿèƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: REQ-701ã€œREQ-704ï¼ˆãŠæ°—ã«å…¥ã‚Šæ©Ÿèƒ½ï¼‰
        // ã€æ‰‹é †ã€‘: å±¥æ­´ã‹ã‚‰ãŠæ°—ã«å…¥ã‚Šç™»éŒ²
        // ã€æœŸå¾…çµæœã€‘: ãŠæ°—ã«å…¥ã‚Šä¸€è¦§ã«è¡¨ç¤ºã•ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: æ–‡å­—åˆ—ã‚’å…¥åŠ›ã—ã¦èª­ã¿ä¸Šã’
        await typeOnCharacterBoard(tester, 'ãŠæ°—ã«å…¥ã‚Šãƒ†ã‚¹ãƒˆ');
        await tapIconButton(tester, Icons.volume_up);
        await tester.pump(const Duration(seconds: 1));

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: å±¥æ­´ç”»é¢ã«é·ç§»
        final historyTabFinder = find.text('å±¥æ­´');
        if (historyTabFinder.evaluate().isNotEmpty) {
          await tester.tap(historyTabFinder);
          await tester.pumpAndSettle();
        }

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
        final favoriteFinder = find.byIcon(Icons.star_border);
        if (favoriteFinder.evaluate().isNotEmpty) {
          await tester.tap(favoriteFinder.first);
          await tester.pumpAndSettle();
        }

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ãŠæ°—ã«å…¥ã‚Šç”»é¢ã«é·ç§»
        final favoriteTabFinder = find.text('ãŠæ°—ã«å…¥ã‚Š');
        if (favoriteTabFinder.evaluate().isNotEmpty) {
          await tester.tap(favoriteTabFinder);
          await tester.pumpAndSettle();
        }

        // ã€çµæœæ¤œè¨¼ã€‘: ãŠæ°—ã«å…¥ã‚Šã«ã€ŒãŠæ°—ã«å…¥ã‚Šãƒ†ã‚¹ãƒˆã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹
        expect(find.text('ãŠæ°—ã«å…¥ã‚Šãƒ†ã‚¹ãƒˆ'), findsWidgets);
        // ã€ç¢ºèªå†…å®¹ã€‘: ãŠæ°—ã«å…¥ã‚Šã«ç™»éŒ²ã•ã‚Œã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-010_favorite_registered');
      },
    );

    // ============================================================
    // RT-012: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-012: æ©Ÿå†…ãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³ï¼‰ã§ã‚‚åŸºæœ¬æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å‹•ä½œã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: NFR-101ï¼ˆã‚ªãƒ•ãƒ©ã‚¤ãƒ³ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆï¼‰
        // ã€æ‰‹é †ã€‘: æ©Ÿå†…ãƒ¢ãƒ¼ãƒ‰â†’æ–‡å­—å…¥åŠ›â†’èª­ã¿ä¸Šã’
        // ã€æœŸå¾…çµæœã€‘: æ–‡å­—ç›¤ãƒ»TTSãƒ»å®šå‹æ–‡ãŒæ­£å¸¸å‹•ä½œã™ã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // Note: æ©Ÿå†…ãƒ¢ãƒ¼ãƒ‰ã¯å®Ÿæ©Ÿã§æ‰‹å‹•è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹
        // ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã§ã¯åŸºæœ¬æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: æ–‡å­—åˆ—ã‚’å…¥åŠ›
        await typeOnCharacterBoard(tester, 'ã‚ªãƒ•ãƒ©ã‚¤ãƒ³');
        expect(find.text('ã‚ªãƒ•ãƒ©ã‚¤ãƒ³'), findsWidgets);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: èª­ã¿ä¸Šã’
        await tapIconButton(tester, Icons.volume_up);
        await tester.pump(const Duration(seconds: 1));

        // ã€çµæœæ¤œè¨¼ã€‘: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚åŸºæœ¬æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹
        // Note: å®Ÿæ©Ÿã§æ©Ÿå†…ãƒ¢ãƒ¼ãƒ‰ã«ã—ã¦ã€æ–‡å­—ç›¤ãƒ»TTSãƒ»å®šå‹æ–‡ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’æ‰‹å‹•ç¢ºèª
        // ã€ç¢ºèªå†…å®¹ã€‘: ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§ã‚‚åŸºæœ¬æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-012_offline_mode');
      },
    );

    // ============================================================
    // RT-013: ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºå¤‰æ›´ãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-013: ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã‚’ã€Œå¤§ã€ã«å¤‰æ›´ã§ãã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºå¤‰æ›´æ©Ÿèƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: REQ-801ï¼ˆãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºå¤‰æ›´ï¼‰
        // ã€æ‰‹é †ã€‘: è¨­å®šã§ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã€Œå¤§ã€ã«å¤‰æ›´
        // ã€æœŸå¾…çµæœã€‘: æ–‡å­—ç›¤ãƒ»å®šå‹æ–‡ãƒ»ãƒœã‚¿ãƒ³ãƒ©ãƒ™ãƒ«ãŒå¤§ããè¡¨ç¤ºã•ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: è¨­å®šç”»é¢ã«é·ç§»
        await tapIconButton(tester, Icons.settings);
        expect(find.text('è¨­å®š'), findsOneWidget);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºã€Œå¤§ã€ã‚’é¸æŠ
        final largeFontFinder = find.text('å¤§');
        if (largeFontFinder.evaluate().isNotEmpty) {
          await tester.tap(largeFontFinder.first);
          await tester.pumpAndSettle();
        }

        // ã€çµæœæ¤œè¨¼ã€‘: ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºãŒã€Œå¤§ã€ã«è¨­å®šã•ã‚Œã‚‹
        expect(find.text('å¤§'), findsWidgets);
        // ã€ç¢ºèªå†…å®¹ã€‘: ãƒ•ã‚©ãƒ³ãƒˆã‚µã‚¤ã‚ºãŒå¤§ããè¡¨ç¤ºã•ã‚Œã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-013_font_size_large');

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ãƒ›ãƒ¼ãƒ ç”»é¢ã«æˆ»ã‚‹
        await tapIconButton(tester, Icons.arrow_back);

        // ã€çµæœæ¤œè¨¼ã€‘: æ–‡å­—ç›¤ã®æ–‡å­—ãŒå¤§ããè¡¨ç¤ºã•ã‚Œã‚‹
        // Note: å®Ÿæ©Ÿã§æ–‡å­—ãŒå®Ÿéš›ã«å¤§ããè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’æ‰‹å‹•ç¢ºèª
      },
    );

    // ============================================================
    // RT-014: ãƒ†ãƒ¼ãƒå¤‰æ›´ãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-014: ãƒ†ãƒ¼ãƒã‚’ã€Œãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã€ã«å¤‰æ›´ã§ãã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: ãƒ†ãƒ¼ãƒå¤‰æ›´æ©Ÿèƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: REQ-802ï¼ˆãƒ†ãƒ¼ãƒå¤‰æ›´ï¼‰
        // ã€æ‰‹é †ã€‘: è¨­å®šã§ãƒ†ãƒ¼ãƒã€Œãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã€ã«å¤‰æ›´
        // ã€æœŸå¾…çµæœã€‘: å…¨ç”»é¢ãŒãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒã«å¤‰æ›´ã•ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: è¨­å®šç”»é¢ã«é·ç§»
        await tapIconButton(tester, Icons.settings);
        expect(find.text('è¨­å®š'), findsOneWidget);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ãƒ†ãƒ¼ãƒã€Œãƒ€ãƒ¼ã‚¯ã€ã‚’é¸æŠ
        final darkThemeFinder = find.text('ãƒ€ãƒ¼ã‚¯');
        if (darkThemeFinder.evaluate().isNotEmpty) {
          await tester.tap(darkThemeFinder.first);
          await tester.pumpAndSettle();
        }

        // ã€çµæœæ¤œè¨¼ã€‘: ãƒ†ãƒ¼ãƒãŒã€Œãƒ€ãƒ¼ã‚¯ã€ã«è¨­å®šã•ã‚Œã‚‹
        expect(find.text('ãƒ€ãƒ¼ã‚¯'), findsWidgets);
        // ã€ç¢ºèªå†…å®¹ã€‘: ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒãŒé©ç”¨ã•ã‚Œã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-014_theme_dark');

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ãƒ›ãƒ¼ãƒ ç”»é¢ã«æˆ»ã‚‹
        await tapIconButton(tester, Icons.arrow_back);

        // ã€çµæœæ¤œè¨¼ã€‘: ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒãŒé©ç”¨ã•ã‚Œã¦ã„ã‚‹
        // Note: å®Ÿæ©Ÿã§ç”»é¢ãŒå®Ÿéš›ã«ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒã«ãªã‚‹ã“ã¨ã‚’æ‰‹å‹•ç¢ºèª
      },
    );

    // ============================================================
    // RT-015: é«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-015: é«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰ã«å¤‰æ›´ã§ãã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: é«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãƒ¢ãƒ¼ãƒ‰æ©Ÿèƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: REQ-5006ï¼ˆã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆæ¯”4.5:1ä»¥ä¸Šï¼‰
        // ã€æ‰‹é †ã€‘: è¨­å®šã§ãƒ†ãƒ¼ãƒã€Œé«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã€ã«å¤‰æ›´
        // ã€æœŸå¾…çµæœã€‘: ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆæ¯”4.5:1ä»¥ä¸Šã§è¡¨ç¤ºã•ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: è¨­å®šç”»é¢ã«é·ç§»
        await tapIconButton(tester, Icons.settings);
        expect(find.text('è¨­å®š'), findsOneWidget);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ãƒ†ãƒ¼ãƒã€Œé«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã€ã‚’é¸æŠ
        final highContrastFinder = find.text('é«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ');
        if (highContrastFinder.evaluate().isNotEmpty) {
          await tester.tap(highContrastFinder.first);
          await tester.pumpAndSettle();
        }

        // ã€çµæœæ¤œè¨¼ã€‘: ãƒ†ãƒ¼ãƒãŒã€Œé«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã€ã«è¨­å®šã•ã‚Œã‚‹
        expect(find.text('é«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ'), findsWidgets);
        // ã€ç¢ºèªå†…å®¹ã€‘: é«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãƒ†ãƒ¼ãƒãŒé©ç”¨ã•ã‚Œã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-015_theme_high_contrast');

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: ãƒ›ãƒ¼ãƒ ç”»é¢ã«æˆ»ã‚‹
        await tapIconButton(tester, Icons.arrow_back);

        // ã€çµæœæ¤œè¨¼ã€‘: é«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãƒ†ãƒ¼ãƒãŒé©ç”¨ã•ã‚Œã¦ã„ã‚‹
        // Note: å®Ÿæ©Ÿã§ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆæ¯”ãŒ4.5:1ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨ã‚’æ‰‹å‹•ç¢ºèª
      },
    );

    // ============================================================
    // RT-016: å¯¾é¢è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆ
    // ============================================================
    testWidgets(
      'RT-016: å¯¾é¢è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ã§ç”»é¢ãŒ180åº¦å›è»¢ã™ã‚‹',
      (tester) async {
        // ã€ãƒ†ã‚¹ãƒˆç›®çš„ã€‘: å¯¾é¢è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰æ©Ÿèƒ½ã‚’ç¢ºèª
        // ã€é–¢é€£è¦ä»¶ã€‘: REQ-501ã€œREQ-503ï¼ˆå¯¾é¢è¡¨ç¤ºæ©Ÿèƒ½ï¼‰
        // ã€æ‰‹é †ã€‘: å¯¾é¢è¡¨ç¤ºãƒœã‚¿ãƒ³ã‚¿ãƒƒãƒ—
        // ã€æœŸå¾…çµæœã€‘: ç”»é¢ãŒ180åº¦å›è»¢ã—ã€ãƒ†ã‚­ã‚¹ãƒˆãŒå¤§ããè¡¨ç¤ºã•ã‚Œã‚‹
        // ğŸ”µ ä¿¡é ¼æ€§ãƒ¬ãƒ™ãƒ«: é’ä¿¡å·

        await pumpApp(tester);

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: æ–‡å­—åˆ—ã‚’å…¥åŠ›
        await typeOnCharacterBoard(tester, 'å¯¾é¢è¡¨ç¤º');

        // ã€å®Ÿéš›ã®å‡¦ç†å®Ÿè¡Œã€‘: å¯¾é¢è¡¨ç¤ºãƒœã‚¿ãƒ³ã‚’ã‚¿ãƒƒãƒ—
        final faceToFaceFinder = find.byIcon(Icons.flip);
        if (faceToFaceFinder.evaluate().isNotEmpty) {
          await tester.tap(faceToFaceFinder);
          await tester.pumpAndSettle();
        }

        // ã€çµæœæ¤œè¨¼ã€‘: å¯¾é¢è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ãŒæœ‰åŠ¹ã«ãªã‚‹
        // Note: å®Ÿæ©Ÿã§ç”»é¢ãŒ180åº¦å›è»¢ã—ã€ãƒ†ã‚­ã‚¹ãƒˆãŒå¤§ããè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’æ‰‹å‹•ç¢ºèª
        // ã€ç¢ºèªå†…å®¹ã€‘: å¯¾é¢è¡¨ç¤ºãƒ¢ãƒ¼ãƒ‰ãŒå‹•ä½œã™ã‚‹ ğŸ”µ

        await takeScreenshot(binding, 'RT-016_face_to_face_mode');
      },
    );
  });
}
