# TDD テストケース - TASK-0057

## 概要
- **タスク**: Riverpod Provider 構造設計
- **フェーズ**: Test Cases（テストケース洗い出し）
- **実行日時**: 2025-11-26

---

## テストケース一覧

### HistoryProvider テスト（TC-057-001 〜 TC-057-012）

#### 正常系テスト

| TC ID | テストケース名 | 内容 | 期待結果 |
|-------|--------------|------|----------|
| TC-057-001 | 履歴を追加できる | `addHistory('こんにちは', HistoryType.manualInput)` を呼び出す | 履歴リストに1件追加される |
| TC-057-002 | 複数の履歴を追加できる | 3件の履歴を順番に追加 | 履歴リストに3件存在する |
| TC-057-003 | 履歴が新しい順で取得できる | 3件追加後に一覧取得 | 最新のものが先頭に来る |
| TC-057-004 | 履歴を削除できる | 追加した履歴を削除 | 履歴リストから削除される |
| TC-057-005 | 履歴を検索できる | `searchHistory('こんにちは')` を呼び出す | マッチする履歴のみ返される |
| TC-057-006 | 履歴タイプを指定できる | 各HistoryType（manualInput, preset, aiConverted, quickButton）で追加 | 正しいタイプで保存される |

#### デフォルト値テスト

| TC ID | テストケース名 | 内容 | 期待結果 |
|-------|--------------|------|----------|
| TC-057-007 | 初期状態は空の履歴リスト | Provider初期化直後 | `histories`が空リスト |
| TC-057-008 | 初期状態はローディングfalse | Provider初期化直後 | `isLoading`がfalse |

#### 異常系テスト

| TC ID | テストケース名 | 内容 | 期待結果 |
|-------|--------------|------|----------|
| TC-057-009 | 空文字の履歴は追加されない | `addHistory('', HistoryType.manualInput)` | 履歴リストに追加されない |
| TC-057-010 | 存在しないIDの削除は無視される | 存在しないIDで`deleteHistory`呼び出し | エラーなし、状態変化なし |
| TC-057-011 | 検索結果が0件の場合 | 存在しないキーワードで検索 | 空のリストが返される |
| TC-057-012 | 履歴にUUIDが自動付与される | 履歴追加時 | id がUUID形式 |

---

### FavoriteProvider テスト（TC-057-013 〜 TC-057-024）

#### 正常系テスト

| TC ID | テストケース名 | 内容 | 期待結果 |
|-------|--------------|------|----------|
| TC-057-013 | お気に入りを追加できる | `addFavorite('ありがとう')` を呼び出す | お気に入りリストに1件追加される |
| TC-057-014 | 複数のお気に入りを追加できる | 3件のお気に入りを順番に追加 | お気に入りリストに3件存在する |
| TC-057-015 | お気に入りを削除できる | 追加したお気に入りを削除 | お気に入りリストから削除される |
| TC-057-016 | お気に入りの並び順を変更できる | `reorderFavorite(id, 0)` を呼び出す | displayOrderが更新される |
| TC-057-017 | お気に入り一覧がdisplayOrder順で取得できる | 並び替え後に一覧取得 | displayOrder順で返される |

#### デフォルト値テスト

| TC ID | テストケース名 | 内容 | 期待結果 |
|-------|--------------|------|----------|
| TC-057-018 | 初期状態は空のお気に入りリスト | Provider初期化直後 | `favorites`が空リスト |
| TC-057-019 | 初期状態はローディングfalse | Provider初期化直後 | `isLoading`がfalse |

#### 異常系テスト

| TC ID | テストケース名 | 内容 | 期待結果 |
|-------|--------------|------|----------|
| TC-057-020 | 空文字のお気に入りは追加されない | `addFavorite('')` | お気に入りリストに追加されない |
| TC-057-021 | 存在しないIDの削除は無視される | 存在しないIDで`deleteFavorite`呼び出し | エラーなし、状態変化なし |
| TC-057-022 | 存在しないIDの並び替えは無視される | 存在しないIDで`reorderFavorite`呼び出し | エラーなし、状態変化なし |
| TC-057-023 | お気に入りにUUIDが自動付与される | お気に入り追加時 | id がUUID形式 |
| TC-057-024 | 重複するコンテンツのお気に入りは追加されない | 同じ内容で2回追加 | 1件のみ存在 |

---

### NetworkProvider テスト（TC-057-025 〜 TC-057-033）

#### 正常系テスト

| TC ID | テストケース名 | 内容 | 期待結果 |
|-------|--------------|------|----------|
| TC-057-025 | オンライン状態を検知できる | ネットワーク接続時 | `NetworkState.online`が返される |
| TC-057-026 | オフライン状態を検知できる | ネットワーク切断時 | `NetworkState.offline`が返される |
| TC-057-027 | オンラインでAI変換が有効 | オンライン時に`isAIConversionAvailable`確認 | `true`が返される |
| TC-057-028 | オフラインでAI変換が無効 | オフライン時に`isAIConversionAvailable`確認 | `false`が返される |
| TC-057-029 | ネットワーク状態変更時に通知される | オンライン→オフライン遷移 | 状態が更新される |

#### デフォルト値テスト

| TC ID | テストケース名 | 内容 | 期待結果 |
|-------|--------------|------|----------|
| TC-057-030 | 初期状態はchecking | Provider初期化直後 | `NetworkState.checking`が返される |

#### 異常系テスト

| TC ID | テストケース名 | 内容 | 期待結果 |
|-------|--------------|------|----------|
| TC-057-031 | 接続チェック失敗時はoffline扱い | 接続チェックでエラー発生 | `NetworkState.offline`になる |
| TC-057-032 | オフラインでも基本機能は動作 | オフライン状態でinputBuffer操作 | 正常動作する |
| TC-057-033 | オフラインでも定型文は動作 | オフライン状態でpresetPhrase操作 | 正常動作する |

---

### app_providers.dart テスト（TC-057-034 〜 TC-057-038）

#### エクスポートテスト

| TC ID | テストケース名 | 内容 | 期待結果 |
|-------|--------------|------|----------|
| TC-057-034 | inputBufferProviderがエクスポートされる | app_providers.dartからインポート | 正常にインポートできる |
| TC-057-035 | presetPhraseNotifierProviderがエクスポートされる | app_providers.dartからインポート | 正常にインポートできる |
| TC-057-036 | historyProviderがエクスポートされる | app_providers.dartからインポート | 正常にインポートできる |
| TC-057-037 | favoriteProviderがエクスポートされる | app_providers.dartからインポート | 正常にインポートできる |
| TC-057-038 | networkProviderがエクスポートされる | app_providers.dartからインポート | 正常にインポートできる |

---

## テストケース数サマリー

| カテゴリ | 正常系 | デフォルト値 | 異常系 | エクスポート | 合計 |
|---------|--------|-------------|--------|--------------|------|
| HistoryProvider | 6 | 2 | 4 | - | 12 |
| FavoriteProvider | 5 | 2 | 5 | - | 12 |
| NetworkProvider | 5 | 1 | 3 | - | 9 |
| app_providers | - | - | - | 5 | 5 |
| **合計** | **16** | **5** | **12** | **5** | **38** |

---

## テストファイル構成

```
test/
├── features/
│   ├── history/
│   │   └── providers/
│   │       └── history_provider_test.dart     # TC-057-001〜TC-057-012
│   ├── favorite/
│   │   └── providers/
│   │       └── favorite_provider_test.dart    # TC-057-013〜TC-057-024
│   └── network/
│       └── providers/
│           └── network_provider_test.dart     # TC-057-025〜TC-057-033
└── shared/
    └── providers/
        └── app_providers_test.dart            # TC-057-034〜TC-057-038
```

---

## 次のステップ

1. TDD Redフェーズ: 失敗するテストコードの作成
2. TDD Greenフェーズ: テストを通す最小限の実装
3. TDD Refactorフェーズ: コード品質の改善
