# TASK-0077: オフライン時UI表示・AI変換無効化 - テストケース

## テスト概要

- **タスクID**: TASK-0077
- **総テストケース数**: 22件
  - OfflineBanner: 6件
  - OnlineRecoveryNotification: 6件
  - 既存テスト（TASK-0058）: 10件
- **テストファイル**:
  - `test/features/network/presentation/widgets/offline_banner_test.dart`
  - `test/features/network/presentation/widgets/online_recovery_notification_test.dart`
  - `test/features/network/offline_ui_test.dart`

---

## 1. OfflineBanner テスト

### 1.1 表示テスト

| TC-ID | テストケース名 | 前提条件 | テスト内容 | 期待結果 | 関連要件 |
|-------|---------------|----------|-----------|----------|----------|
| TC-077-001 | オフライン時にバナーが表示される | オフライン状態 | OfflineBannerを表示 | 「オフライン - 基本機能のみ利用可能」とwifi_offアイコンが表示 | BAN-001, BAN-002, BAN-003 |
| TC-077-002 | オンライン時にバナーが非表示 | オンライン状態 | OfflineBannerを表示 | バナーが表示されない | BAN-004 |
| TC-077-003 | checking時にバナーが非表示 | checking状態 | OfflineBannerを表示 | バナーが表示されない | BAN-005 |

### 1.2 状態変更テスト

| TC-ID | テストケース名 | 前提条件 | テスト内容 | 期待結果 | 関連要件 |
|-------|---------------|----------|-----------|----------|----------|
| TC-077-004 | オンラインからオフラインへの変更でバナーが表示される | オンライン状態 | オフラインに切り替え | バナーが表示される | BAN-006 |
| TC-077-005 | オフラインからオンラインへの変更でバナーが非表示になる | オフライン状態 | オンラインに切り替え | バナーが非表示になる | BAN-006 |

### 1.3 アクセシビリティテスト

| TC-ID | テストケース名 | 前提条件 | テスト内容 | 期待結果 | 関連要件 |
|-------|---------------|----------|-----------|----------|----------|
| TC-077-006 | バナーにSemanticsラベルがある | オフライン状態 | Semanticsウィジェットを確認 | Semanticsが存在する | BAN-007 |

---

## 2. OnlineRecoveryNotification テスト

### 2.1 表示テスト

| TC-ID | テストケース名 | 前提条件 | テスト内容 | 期待結果 | 関連要件 |
|-------|---------------|----------|-----------|----------|----------|
| TC-077-007 | オフライン→オンラインで復帰通知が表示される | オフライン状態 | オンラインに復帰 | 「オンラインに戻りました。AI変換が利用可能です」が表示 | REC-001, REC-002 |
| TC-077-008 | オンライン→オンラインでは通知が表示されない | オンライン状態 | 再度オンラインに設定 | 通知が表示されない | REC-003 |
| TC-077-009 | checking→オンラインでは通知が表示されない | checking状態 | オンラインに変更 | 通知が表示されない | REC-004 |

### 2.2 自動非表示テスト

| TC-ID | テストケース名 | 前提条件 | テスト内容 | 期待結果 | 関連要件 |
|-------|---------------|----------|-----------|----------|----------|
| TC-077-010 | 復帰通知が一定時間後に自動で非表示になる | オフライン状態 | オンライン復帰後、時間経過 | 通知が非表示になる | REC-005, REC-006 |

### 2.3 ユーザー操作テスト

| TC-ID | テストケース名 | 前提条件 | テスト内容 | 期待結果 | 関連要件 |
|-------|---------------|----------|-----------|----------|----------|
| TC-077-011 | 通知表示中も子ウィジェットが操作可能 | オフライン→オンライン | 復帰通知表示中にボタンをタップ | ボタンが操作可能 | REC-008, NFR-203 |

### 2.4 アクセシビリティテスト

| TC-ID | テストケース名 | 前提条件 | テスト内容 | 期待結果 | 関連要件 |
|-------|---------------|----------|-----------|----------|----------|
| TC-077-012 | 通知にSemanticsラベルがある | オフライン→オンライン | Semanticsウィジェットを確認 | Semanticsが存在する | REC-009 |

---

## 3. 既存テスト（TASK-0058からの継承）

### 3.1 オフラインインジケーターテスト

| TC-ID | テストケース名 | 関連要件 |
|-------|---------------|----------|
| TC-058-032 | オフライン時にインジケーターが表示される | REQ-1002 |
| TC-058-033 | オンライン時にインジケーターが非表示 | REQ-1002 |
| TC-058-034 | オンライン復帰でインジケーターが消える | REQ-1002 |
| TC-058-035 | checking時はインジケーターが非表示 | REQ-1002 |

### 3.2 オンライン復帰通知テスト

| TC-ID | テストケース名 | 関連要件 |
|-------|---------------|----------|
| TC-058-036 | オフラインからオンライン復帰で通知が表示される | EDGE-001 |
| TC-058-037 | 復帰通知が一定時間後に消える | EDGE-001 |
| TC-058-038 | 通知表示中も操作が可能 | NFR-203 |

### 3.3 AI変換ボタン視覚的無効化テスト

| TC-ID | テストケース名 | 関連要件 |
|-------|---------------|----------|
| TC-058-AI-001 | オフライン時にAI変換ボタンが無効化される | REQ-3004 |
| TC-058-AI-002 | オンライン復帰でAI変換ボタンが有効化される | REQ-3004 |
| TC-058-AI-003 | 無効化時のボタン外観が適切 | REQ-3004 |

---

## テスト実行コマンド

```bash
# 全テスト実行
flutter test test/features/network/

# 個別テスト実行
flutter test test/features/network/presentation/widgets/offline_banner_test.dart
flutter test test/features/network/presentation/widgets/online_recovery_notification_test.dart
flutter test test/features/network/offline_ui_test.dart
```

## テスト結果

```
60 tests passed (network feature tests)
```
