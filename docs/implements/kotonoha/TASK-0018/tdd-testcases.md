# TASK-0018: ユーティリティ関数実装 TDDテストケース一覧

## 概要

- **タスクID**: TASK-0018
- **タスク名**: ユーティリティ関数実装（Logger、バリデーション、エラーハンドリング）
- **作成日**: 2025-11-22
- **テスト対象ファイル**:
  - `lib/core/utils/logger.dart`
  - `lib/core/utils/validators.dart`
  - `lib/core/utils/error_handler.dart`
  - `lib/core/utils/exceptions.dart`
- **テストファイル**:
  - `test/core/utils/logger_test.dart`
  - `test/core/utils/validators_test.dart`
  - `test/core/utils/error_handler_test.dart`

## 信頼性レベル凡例

- **🔵 青信号**: 要件定義書・テストケース定義書に基づく確実なテスト
- **🟡 黄信号**: 要件定義書から妥当な推測によるテスト
- **🔴 赤信号**: 要件定義書にない推測によるテスト

---

## 1. Loggerユーティリティ テストケース

### 対象クラス: `AppLogger`
### テストファイル: `test/core/utils/logger_test.dart`

---

### TC-LOG-001: デバッグログ出力テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-LOG-001 |
| **テストケース名** | デバッグログ出力テスト |
| **説明** | AppLogger.debug()が正常にデバッグレベルのログを出力できることを確認する |
| **優先度** | Medium |
| **信頼性** | 🟡 黄信号（一般的なログ実装に基づく推測） |
| **関連要件** | FR-LOGGER-001 |

**前提条件**:
- AppLoggerクラスがインポートされている
- アプリケーションが開発環境で実行されている

**入力値**:
```dart
message: 'テストデバッグメッセージ'
```

**期待結果**:
- デバッグレベルのログが出力される
- ログにメッセージ「テストデバッグメッセージ」が含まれる
- ログにタイムスタンプが含まれる
- ログに「DEBUG」レベル表示が含まれる

---

### TC-LOG-002: 情報ログ出力テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-LOG-002 |
| **テストケース名** | 情報ログ出力テスト |
| **説明** | AppLogger.info()が正常に情報レベルのログを出力できることを確認する |
| **優先度** | Medium |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-LOGGER-002 |

**前提条件**:
- AppLoggerクラスがインポートされている

**入力値**:
```dart
message: 'アプリケーション起動完了'
```

**期待結果**:
- 情報レベルのログが出力される
- ログにメッセージ「アプリケーション起動完了」が含まれる
- ログに「INFO」レベル表示が含まれる

---

### TC-LOG-003: 警告ログ出力テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-LOG-003 |
| **テストケース名** | 警告ログ出力テスト |
| **説明** | AppLogger.warning()が正常に警告レベルのログを出力できることを確認する |
| **優先度** | Medium |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-LOGGER-003 |

**前提条件**:
- AppLoggerクラスがインポートされている

**入力値**:
```dart
message: 'ネットワーク接続が不安定です'
```

**期待結果**:
- 警告レベルのログが出力される
- ログにメッセージ「ネットワーク接続が不安定です」が含まれる
- ログに「WARNING」レベル表示が含まれる

---

### TC-LOG-004: エラーログ出力テスト（例外情報なし）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-LOG-004 |
| **テストケース名** | エラーログ出力テスト（例外情報なし） |
| **説明** | AppLogger.error()がエラーメッセージのみでエラーログを出力できることを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（NFR-301に基づく） |
| **関連要件** | FR-LOGGER-004, AC-LOGGER-002 |

**前提条件**:
- AppLoggerクラスがインポートされている

**入力値**:
```dart
message: 'AI変換処理でエラーが発生'
error: null
stackTrace: null
```

**期待結果**:
- エラーレベルのログが出力される
- ログにメッセージ「AI変換処理でエラーが発生」が含まれる
- ログに「ERROR」レベル表示が含まれる

---

### TC-LOG-005: エラーログ出力テスト（例外情報・スタックトレース付き）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-LOG-005 |
| **テストケース名** | エラーログ出力テスト（例外情報・スタックトレース付き） |
| **説明** | AppLogger.error()が例外情報とスタックトレースを含むエラーログを出力できることを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（NFR-301に基づく） |
| **関連要件** | FR-LOGGER-004, AC-LOGGER-002 |

**前提条件**:
- AppLoggerクラスがインポートされている
- Exception例外オブジェクトが存在する
- StackTraceオブジェクトが存在する

**入力値**:
```dart
message: 'ネットワークエラー発生'
error: Exception('接続に失敗しました')
stackTrace: StackTrace.current
```

**期待結果**:
- エラーレベルのログが出力される
- ログにメッセージ「ネットワークエラー発生」が含まれる
- ログに例外情報「接続に失敗しました」が含まれる
- ログにスタックトレースが含まれる
- ログに「ERROR」レベル表示が含まれる

---

### TC-LOG-006: 本番環境でのデバッグログ抑制テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-LOG-006 |
| **テストケース名** | 本番環境でのデバッグログ抑制テスト |
| **説明** | 本番環境（kReleaseMode）ではデバッグログが出力されないことを確認する |
| **優先度** | Low |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-LOGGER-005 |

**前提条件**:
- AppLoggerクラスがインポートされている
- 本番環境（kReleaseMode = true）をシミュレート

**入力値**:
```dart
message: 'デバッグ情報'
isRelease: true  // シミュレーション用
```

**期待結果**:
- デバッグログが出力されない（抑制される）
- info、warning、errorログは引き続き出力される

---

### TC-LOG-007: ログタグ付き出力テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-LOG-007 |
| **テストケース名** | ログタグ付き出力テスト |
| **説明** | AppLoggerがタグ（機能名等）付きでログを出力できることを確認する |
| **優先度** | Low |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-LOGGER-001〜004 |

**前提条件**:
- AppLoggerクラスがインポートされている

**入力値**:
```dart
tag: 'AIConverter'
message: '変換処理開始'
```

**期待結果**:
- ログに機能タグ「AIConverter」が含まれる
- ログの出力元が識別しやすくなる

---

## 2. バリデーションユーティリティ テストケース

### 対象クラス: `Validators`
### テストファイル: `test/core/utils/validators_test.dart`

---

### TC-VAL-001: 入力テキスト正常値テスト（短い文字列）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-001 |
| **テストケース名** | 入力テキスト正常値テスト（短い文字列） |
| **説明** | 短い入力テキストが正常に検証を通過することを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（EDGE-101に基づく） |
| **関連要件** | FR-VALID-001, AC-VALID-001 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: 'こんにちは'  // 5文字
```

**期待結果**:
- 戻り値が`null`（エラーなし）

---

### TC-VAL-002: 入力テキスト境界値テスト（ちょうど1000文字）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-002 |
| **テストケース名** | 入力テキスト境界値テスト（ちょうど1000文字） |
| **説明** | ちょうど1000文字の入力テキストが正常に検証を通過することを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（EDGE-101に基づく） |
| **関連要件** | FR-VALID-001, AC-VALID-009 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: 'あ' * 1000  // ちょうど1000文字
```

**期待結果**:
- 戻り値が`null`（エラーなし、1000文字はOK）

---

### TC-VAL-003: 入力テキスト上限超過テスト（1001文字）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-003 |
| **テストケース名** | 入力テキスト上限超過テスト（1001文字） |
| **説明** | 1001文字の入力テキストがエラーになることを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（EDGE-101に基づく） |
| **関連要件** | FR-VALID-001, AC-VALID-002 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: 'あ' * 1001  // 1001文字
```

**期待結果**:
- 戻り値に「1000文字以内」を含むエラーメッセージが返される
- 例: `'入力は1000文字以内にしてください'`

---

### TC-VAL-004: 入力テキスト上限大幅超過テスト（2000文字）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-004 |
| **テストケース名** | 入力テキスト上限大幅超過テスト（2000文字） |
| **説明** | 大幅に上限を超えた入力テキストがエラーになることを確認する |
| **優先度** | Medium |
| **信頼性** | 🔵 青信号 |
| **関連要件** | FR-VALID-001 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: 'あ' * 2000  // 2000文字
```

**期待結果**:
- 戻り値に「1000文字以内」を含むエラーメッセージが返される

---

### TC-VAL-005: 入力テキスト空文字テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-005 |
| **テストケース名** | 入力テキスト空文字テスト |
| **説明** | 空文字の入力テキストが正常に検証を通過することを確認する（空入力は許可） |
| **優先度** | High |
| **信頼性** | 🔵 青信号 |
| **関連要件** | FR-VALID-001, AC-VALID-003 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: ''  // 空文字
```

**期待結果**:
- 戻り値が`null`（空入力は許可）

---

### TC-VAL-006: 入力テキストnullテスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-006 |
| **テストケース名** | 入力テキストnullテスト |
| **説明** | nullの入力テキストが正常に検証を通過することを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号 |
| **関連要件** | FR-VALID-001, AC-VALID-003 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: null
```

**期待結果**:
- 戻り値が`null`（nullは空入力として許可）

---

### TC-VAL-007: 定型文正常値テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-007 |
| **テストケース名** | 定型文正常値テスト |
| **説明** | 短い定型文テキストが正常に検証を通過することを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（EDGE-102に基づく） |
| **関連要件** | FR-VALID-002, AC-VALID-004 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: 'ありがとうございます'  // 10文字
```

**期待結果**:
- 戻り値が`null`（エラーなし）

---

### TC-VAL-008: 定型文境界値テスト（ちょうど500文字）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-008 |
| **テストケース名** | 定型文境界値テスト（ちょうど500文字） |
| **説明** | ちょうど500文字の定型文が正常に検証を通過することを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（EDGE-102に基づく） |
| **関連要件** | FR-VALID-002, AC-VALID-010 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: 'あ' * 500  // ちょうど500文字
```

**期待結果**:
- 戻り値が`null`（エラーなし、500文字はOK）

---

### TC-VAL-009: 定型文上限超過テスト（501文字）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-009 |
| **テストケース名** | 定型文上限超過テスト（501文字） |
| **説明** | 501文字の定型文がエラーになることを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（EDGE-102に基づく） |
| **関連要件** | FR-VALID-002, AC-VALID-006 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: 'あ' * 501  // 501文字
```

**期待結果**:
- 戻り値に「500文字以内」を含むエラーメッセージが返される
- 例: `'定型文は500文字以内にしてください'`

---

### TC-VAL-010: 定型文空文字テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-010 |
| **テストケース名** | 定型文空文字テスト |
| **説明** | 空文字の定型文がエラーになることを確認する（定型文は必須） |
| **優先度** | High |
| **信頼性** | 🔵 青信号 |
| **関連要件** | FR-VALID-002, AC-VALID-005 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: ''  // 空文字
```

**期待結果**:
- 戻り値に「定型文を入力してください」エラーメッセージが返される

---

### TC-VAL-011: 定型文nullテスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-011 |
| **テストケース名** | 定型文nullテスト |
| **説明** | nullの定型文がエラーになることを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号 |
| **関連要件** | FR-VALID-002, AC-VALID-005 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: null
```

**期待結果**:
- 戻り値に「定型文を入力してください」エラーメッセージが返される

---

### TC-VAL-012: 定型文空白のみテスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-012 |
| **テストケース名** | 定型文空白のみテスト |
| **説明** | 空白のみの定型文がエラーになることを確認する |
| **優先度** | Medium |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-VALID-002, FR-VALID-004 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: '   '  // 空白のみ
text: '　'   // 全角スペースのみ
text: '\t'   // タブのみ
```

**期待結果**:
- 戻り値に「定型文を入力してください」エラーメッセージが返される
- サニタイズ後に空になるためエラー

---

### TC-VAL-013: AI変換可能判定テスト（変換可能：2文字）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-013 |
| **テストケース名** | AI変換可能判定テスト（変換可能：2文字） |
| **説明** | 2文字以上の入力でAI変換が可能であることを確認する |
| **優先度** | High |
| **信頼性** | 🔴 赤信号（EDGE-105に基づく推測） |
| **関連要件** | FR-VALID-003, AC-VALID-007 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: 'ああ'  // 2文字（境界値）
```

**期待結果**:
- 戻り値が`true`（変換可能）

---

### TC-VAL-014: AI変換可能判定テスト（変換可能：長い文字列）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-014 |
| **テストケース名** | AI変換可能判定テスト（変換可能：長い文字列） |
| **説明** | 十分に長い入力でAI変換が可能であることを確認する |
| **優先度** | Medium |
| **信頼性** | 🔴 赤信号 |
| **関連要件** | FR-VALID-003 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: 'おはようございます今日もよろしくお願いします'  // 20文字
```

**期待結果**:
- 戻り値が`true`（変換可能）

---

### TC-VAL-015: AI変換可能判定テスト（変換不可：1文字）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-015 |
| **テストケース名** | AI変換可能判定テスト（変換不可：1文字） |
| **説明** | 1文字の入力でAI変換が不可であることを確認する |
| **優先度** | High |
| **信頼性** | 🔴 赤信号（EDGE-105に基づく推測） |
| **関連要件** | FR-VALID-003, AC-VALID-008 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: 'あ'  // 1文字
```

**期待結果**:
- 戻り値が`false`（変換不可）

---

### TC-VAL-016: AI変換可能判定テスト（変換不可：空文字）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-016 |
| **テストケース名** | AI変換可能判定テスト（変換不可：空文字） |
| **説明** | 空文字の入力でAI変換が不可であることを確認する |
| **優先度** | High |
| **信頼性** | 🔴 赤信号 |
| **関連要件** | FR-VALID-003 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: ''  // 空文字
```

**期待結果**:
- 戻り値が`false`（変換不可）

---

### TC-VAL-017: AI変換可能判定テスト（変換不可：null）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-017 |
| **テストケース名** | AI変換可能判定テスト（変換不可：null） |
| **説明** | nullの入力でAI変換が不可であることを確認する |
| **優先度** | Medium |
| **信頼性** | 🔴 赤信号 |
| **関連要件** | FR-VALID-003 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: null
```

**期待結果**:
- 戻り値が`false`（変換不可）

---

### TC-VAL-018: AI変換可能判定テスト（空白のみは変換不可）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-018 |
| **テストケース名** | AI変換可能判定テスト（空白のみは変換不可） |
| **説明** | 空白のみの入力でAI変換が不可であることを確認する |
| **優先度** | Medium |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-VALID-003, FR-VALID-004 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: '   '  // 空白のみ
```

**期待結果**:
- 戻り値が`false`（サニタイズ後に空になるため変換不可）

---

### TC-VAL-019: 入力テキストサニタイズテスト（前後空白除去）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-019 |
| **テストケース名** | 入力テキストサニタイズテスト（前後空白除去） |
| **説明** | 前後の空白が正しく除去されることを確認する |
| **優先度** | Medium |
| **信頼性** | 🟡 黄信号（一般的な入力処理に基づく） |
| **関連要件** | FR-VALID-004 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: '  こんにちは  '  // 前後に半角スペース
```

**期待結果**:
- 戻り値が`'こんにちは'`（前後の空白が除去）

---

### TC-VAL-020: 入力テキストサニタイズテスト（全角スペース除去）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-020 |
| **テストケース名** | 入力テキストサニタイズテスト（全角スペース除去） |
| **説明** | 全角スペースが正しく除去されることを確認する |
| **優先度** | Medium |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-VALID-004 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: '　こんにちは　'  // 前後に全角スペース
```

**期待結果**:
- 戻り値が`'こんにちは'`（全角スペースも除去）

---

### TC-VAL-021: 入力テキストサニタイズテスト（タブ・改行除去）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-021 |
| **テストケース名** | 入力テキストサニタイズテスト（タブ・改行除去） |
| **説明** | タブや改行が正しく除去されることを確認する |
| **優先度** | Low |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-VALID-004 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: '\n\tこんにちは\t\n'  // タブと改行
```

**期待結果**:
- 戻り値が`'こんにちは'`（タブと改行が除去）

---

### TC-VAL-022: 入力テキストサニタイズテスト（中間の空白は保持）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-VAL-022 |
| **テストケース名** | 入力テキストサニタイズテスト（中間の空白は保持） |
| **説明** | テキスト中間の空白は保持されることを確認する |
| **優先度** | Medium |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-VALID-004 |

**前提条件**:
- Validatorsクラスがインポートされている

**入力値**:
```dart
text: '  こんにちは 世界  '  // 中間にスペースあり
```

**期待結果**:
- 戻り値が`'こんにちは 世界'`（前後のみ除去、中間は保持）

---

## 3. エラーハンドリングユーティリティ テストケース

### 対象クラス: `ErrorHandler`, カスタム例外クラス
### テストファイル: `test/core/utils/error_handler_test.dart`

---

### TC-ERR-001: NetworkException生成テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-001 |
| **テストケース名** | NetworkException生成テスト |
| **説明** | NetworkExceptionが正しく生成されることを確認する |
| **優先度** | High |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-ERROR-005 |

**前提条件**:
- NetworkExceptionクラスがインポートされている

**入力値**:
```dart
message: '接続エラー'
```

**期待結果**:
- NetworkException例外が生成される
- exception.messageが「接続エラー」を含む
- exception.toString()が意味のある文字列を返す

---

### TC-ERR-002: TimeoutException生成テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-002 |
| **テストケース名** | TimeoutException生成テスト |
| **説明** | TimeoutExceptionが正しく生成されることを確認する |
| **優先度** | High |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-ERROR-005 |

**前提条件**:
- TimeoutExceptionクラス（app固有版）がインポートされている

**入力値**:
```dart
message: 'タイムアウト'
duration: Duration(seconds: 30)  // オプション
```

**期待結果**:
- TimeoutException例外が生成される
- exception.messageが「タイムアウト」を含む

---

### TC-ERR-003: AiConversionException生成テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-003 |
| **テストケース名** | AiConversionException生成テスト |
| **説明** | AiConversionExceptionが正しく生成されることを確認する |
| **優先度** | High |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-ERROR-005 |

**前提条件**:
- AiConversionExceptionクラスがインポートされている

**入力値**:
```dart
message: '変換失敗'
originalText: 'こんにちは'  // オプション: 元のテキスト
```

**期待結果**:
- AiConversionException例外が生成される
- exception.messageが「変換失敗」を含む
- exception.originalTextが「こんにちは」である（オプション）

---

### TC-ERR-004: ValidationException生成テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-004 |
| **テストケース名** | ValidationException生成テスト |
| **説明** | ValidationExceptionが正しく生成されることを確認する |
| **優先度** | Medium |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-ERROR-005 |

**前提条件**:
- ValidationExceptionクラスがインポートされている

**入力値**:
```dart
message: '入力値が無効です'
field: 'inputText'  // オプション: エラーのあるフィールド
```

**期待結果**:
- ValidationException例外が生成される
- exception.messageが「入力値が無効です」を含む

---

### TC-ERR-005: ネットワークエラーメッセージ生成テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-005 |
| **テストケース名** | ネットワークエラーメッセージ生成テスト |
| **説明** | NetworkExceptionに対して適切な日本語メッセージが生成されることを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（NFR-204、EDGE-001に基づく） |
| **関連要件** | FR-ERROR-001, AC-ERROR-001 |

**前提条件**:
- ErrorHandlerクラスがインポートされている
- NetworkException例外が発生している

**入力値**:
```dart
error: NetworkException('接続エラー')
```

**期待結果**:
- 戻り値に「ネットワークエラー」を含む
- 戻り値に「インターネット接続を確認」を含む
- メッセージが日本語で記述されている
- 例: `'ネットワークエラーが発生しました。インターネット接続を確認してください。'`

---

### TC-ERR-006: タイムアウトエラーメッセージ生成テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-006 |
| **テストケース名** | タイムアウトエラーメッセージ生成テスト |
| **説明** | TimeoutExceptionに対して適切な日本語メッセージが生成されることを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（NFR-204、EDGE-001に基づく） |
| **関連要件** | FR-ERROR-002, AC-ERROR-002 |

**前提条件**:
- ErrorHandlerクラスがインポートされている
- TimeoutException例外が発生している

**入力値**:
```dart
error: AppTimeoutException('タイムアウト')
```

**期待結果**:
- 戻り値に「タイムアウト」を含む
- 戻り値に「もう一度お試しください」を含む
- メッセージが日本語で記述されている
- 例: `'通信がタイムアウトしました。しばらく待ってからもう一度お試しください。'`

---

### TC-ERR-007: AI変換エラーメッセージ生成テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-007 |
| **テストケース名** | AI変換エラーメッセージ生成テスト |
| **説明** | AiConversionExceptionに対して適切な日本語メッセージが生成されることを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（NFR-204、EDGE-002に基づく） |
| **関連要件** | FR-ERROR-003, AC-ERROR-003 |

**前提条件**:
- ErrorHandlerクラスがインポートされている
- AiConversionException例外が発生している

**入力値**:
```dart
error: AiConversionException('変換失敗')
```

**期待結果**:
- 戻り値に「変換に失敗しました」を含む
- 戻り値に「元の文」を含む
- メッセージが日本語で記述されている
- 例: `'変換に失敗しました。元の文をそのまま使用できます。'`

---

### TC-ERR-008: 汎用エラーメッセージ生成テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-008 |
| **テストケース名** | 汎用エラーメッセージ生成テスト |
| **説明** | 予期しない例外に対して適切な日本語メッセージが生成されることを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（NFR-204に基づく） |
| **関連要件** | FR-ERROR-004, AC-ERROR-004 |

**前提条件**:
- ErrorHandlerクラスがインポートされている
- 予期しない例外（Exception）が発生している

**入力値**:
```dart
error: Exception('未知のエラー')
```

**期待結果**:
- 戻り値に「予期しないエラー」を含む
- メッセージが日本語で記述されている
- 例: `'予期しないエラーが発生しました。アプリを再起動してください。'`

---

### TC-ERR-009: ValidationExceptionメッセージ生成テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-009 |
| **テストケース名** | ValidationExceptionメッセージ生成テスト |
| **説明** | ValidationExceptionに対して適切なメッセージが生成されることを確認する |
| **優先度** | Medium |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-ERROR-004 |

**前提条件**:
- ErrorHandlerクラスがインポートされている
- ValidationException例外が発生している

**入力値**:
```dart
error: ValidationException('入力値が無効です')
```

**期待結果**:
- 戻り値に「入力値が無効です」を含む
- ValidationExceptionのメッセージがそのまま使用される

---

### TC-ERR-010: エラーハンドリング時のログ記録テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-010 |
| **テストケース名** | エラーハンドリング時のログ記録テスト |
| **説明** | ErrorHandler.handleError()がエラーログを記録することを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（NFR-301に基づく） |
| **関連要件** | FR-ERROR-006, AC-ERROR-005 |

**前提条件**:
- ErrorHandlerクラスとAppLoggerクラスがインポートされている
- エラーが発生している

**入力値**:
```dart
error: NetworkException('テストエラー')
stackTrace: StackTrace.current
```

**期待結果**:
- AppLoggerにエラーログが記録される
- ログにエラー内容「テストエラー」が含まれる
- ログにスタックトレースが含まれる

---

### TC-ERR-011: エラー再試行可能判定テスト（ネットワークエラー）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-011 |
| **テストケース名** | エラー再試行可能判定テスト（ネットワークエラー） |
| **説明** | ネットワークエラーが再試行可能と判定されることを確認する |
| **優先度** | Medium |
| **信頼性** | 🔵 青信号（EDGE-001に基づく） |
| **関連要件** | FR-ERROR-001 |

**前提条件**:
- ErrorHandlerクラスがインポートされている

**入力値**:
```dart
error: NetworkException('接続エラー')
```

**期待結果**:
- `ErrorHandler.isRetryable(error)` が`true`を返す

---

### TC-ERR-012: エラー再試行可能判定テスト（タイムアウト）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-012 |
| **テストケース名** | エラー再試行可能判定テスト（タイムアウト） |
| **説明** | タイムアウトエラーが再試行可能と判定されることを確認する |
| **優先度** | Medium |
| **信頼性** | 🔵 青信号（EDGE-001に基づく） |
| **関連要件** | FR-ERROR-002 |

**前提条件**:
- ErrorHandlerクラスがインポートされている

**入力値**:
```dart
error: AppTimeoutException('タイムアウト')
```

**期待結果**:
- `ErrorHandler.isRetryable(error)` が`true`を返す

---

### TC-ERR-013: エラー再試行可能判定テスト（バリデーションエラー）
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-013 |
| **テストケース名** | エラー再試行可能判定テスト（バリデーションエラー） |
| **説明** | バリデーションエラーが再試行不可と判定されることを確認する |
| **優先度** | Medium |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-ERROR-005 |

**前提条件**:
- ErrorHandlerクラスがインポートされている

**入力値**:
```dart
error: ValidationException('入力値が無効')
```

**期待結果**:
- `ErrorHandler.isRetryable(error)` が`false`を返す
- バリデーションエラーはユーザーの入力修正が必要

---

### TC-ERR-014: SnackBar表示用データ生成テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-014 |
| **テストケース名** | SnackBar表示用データ生成テスト |
| **説明** | ErrorHandlerがSnackBar表示に必要なデータを生成することを確認する |
| **優先度** | Medium |
| **信頼性** | 🔵 青信号（NFR-204に基づく） |
| **関連要件** | FR-ERROR-007 |

**前提条件**:
- ErrorHandlerクラスがインポートされている

**入力値**:
```dart
error: NetworkException('接続エラー')
```

**期待結果**:
- SnackBar表示用のメッセージが取得できる
- メッセージが日本語で記述されている
- オプションで再試行アクションのラベルが取得できる

---

### TC-ERR-015: エラー発生時のアプリ継続動作テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-015 |
| **テストケース名** | エラー発生時のアプリ継続動作テスト |
| **説明** | エラーが発生してもアプリがクラッシュせず継続動作することを確認する |
| **優先度** | High |
| **信頼性** | 🔵 青信号（NFR-301に基づく） |
| **関連要件** | NFR-UTIL-002, AC-ERROR-005 |

**前提条件**:
- ErrorHandlerクラスがインポートされている
- 例外がスローされた

**入力値**:
```dart
error: Exception('テストエラー')
```

**期待結果**:
- ErrorHandler.handleError()が例外をキャッチして処理
- 処理後に例外がスローされない
- アプリケーションが継続動作可能

---

### TC-ERR-016: nullエラーオブジェクト処理テスト
| 項目 | 内容 |
|------|------|
| **テストケースID** | TC-ERR-016 |
| **テストケース名** | nullエラーオブジェクト処理テスト |
| **説明** | nullのエラーオブジェクトが渡された場合の処理を確認する |
| **優先度** | Low |
| **信頼性** | 🟡 黄信号 |
| **関連要件** | FR-ERROR-004 |

**前提条件**:
- ErrorHandlerクラスがインポートされている

**入力値**:
```dart
error: null
```

**期待結果**:
- 汎用エラーメッセージが返される
- アプリがクラッシュしない

---

## テストケースサマリー

### テストケース総数: 38件

| カテゴリ | 件数 | High | Medium | Low |
|---------|------|------|--------|-----|
| Logger | 7 | 2 | 4 | 1 |
| Validation | 22 | 14 | 7 | 1 |
| Error Handling | 16 | 7 | 8 | 1 |
| **合計** | **38** | **23** | **19** | **3** |

### 信頼性レベル分布

| レベル | 件数 | 割合 |
|--------|------|------|
| 🔵 青信号 | 24件 | 63% |
| 🟡 黄信号 | 11件 | 29% |
| 🔴 赤信号 | 3件 | 8% |

### テスト実行順序（推奨）

1. **Phase 1: カスタム例外クラス**
   - TC-ERR-001〜TC-ERR-004

2. **Phase 2: Loggerユーティリティ**
   - TC-LOG-001〜TC-LOG-007

3. **Phase 3: バリデーションユーティリティ**
   - TC-VAL-001〜TC-VAL-022

4. **Phase 4: エラーハンドリングユーティリティ**
   - TC-ERR-005〜TC-ERR-016

---

## 更新履歴

- **2025-11-22**: TDDテストケース一覧作成（tdd-testcases.md）
