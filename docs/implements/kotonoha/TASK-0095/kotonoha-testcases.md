# TASK-0095: 実機テスト（iOS/Android/タブレット） - テストケース定義書

## ドキュメント情報

- **タスクID**: TASK-0095
- **タスク名**: 実機テスト（iOS/Android/タブレット）
- **作成日**: 2025-12-02
- **信頼性レベル**: 🔵 青信号（NFR-401, NFR-402, NFR-403に基づく）
- **関連要件**: NFR-401, NFR-402, NFR-403, REQ-401〜REQ-404, NFR-001〜NFR-003

## 目次

1. [テスト概要](#テスト概要)
2. [テスト環境](#テスト環境)
3. [テストファイル構成](#テストファイル構成)
4. [基本動作テストケース](#基本動作テストケース)
5. [画面方向対応テストケース](#画面方向対応テストケース)
6. [タブレット表示テストケース](#タブレット表示テストケース)
7. [TTS実機動作テストケース](#tts実機動作テストケース)
8. [エッジケース・エラーハンドリングテストケース](#エッジケース・エラーハンドリングテストケース)
9. [テスト実行方法](#テスト実行方法)
10. [受け入れ基準](#受け入れ基準)

---

## テスト概要

### テストの目的 🔵

kotonohaアプリが、iOS/Android実機、タブレット端末で正常に動作することを検証する。

**主要な検証項目**:
1. iOS/Android実機での基本機能動作
2. 縦向き・横向き両対応
3. 9.7インチ以上タブレットでの最適表示
4. TTS実機動作（iOS AVSpeechSynthesizer、Android TextToSpeech）
5. タップターゲットサイズ（44px × 44px以上）
6. プラットフォーム固有機能（SafeArea、Navigation Bar、ガイド付きアクセス等）

### テスト範囲 🔵

**対象範囲**:
- すべてのプラットフォーム（iOS/Android）での基本機能動作
- 各プラットフォーム固有のTTS実装（OS標準TTS）
- タブレット端末での表示最適化
- 画面の縦向き・横向き切り替え対応
- タップ操作の応答性・誤タップ防止

**対象外範囲**:
- パフォーマンスベンチマーク（TASK-0088で実施済み）
- E2Eテストの自動化（TASK-0081〜TASK-0087で実施済み）
- ストアリリース・配布手順（TASK-0099で実施）

---

## テスト環境

### 推奨テスト環境 🔵

#### iOS実機テスト環境

| 項目 | 詳細 |
|------|------|
| **最小バージョン** | iOS 14.0以上 |
| **推奨デバイス** | iPhone SE (第2世代)以上、iPad (第7世代、10.2インチ)以上、iPad Air (第3世代、10.5インチ)以上 |
| **配布方法** | TestFlight経由 |
| **固有確認項目** | AVSpeechSynthesizer、SafeArea対応、ガイド付きアクセス |

#### Android実機テスト環境

| 項目 | 詳細 |
|------|------|
| **最小バージョン** | Android 10（API Level 29）以上 |
| **推奨デバイス** | Google Pixel 5以上、Samsung Galaxy Tab A7 (10.4インチ)以上 |
| **配布方法** | Google Play Console 内部テスト経由 |
| **固有確認項目** | TextToSpeech、Navigation Bar対応、画面ピン留め |

---

## テストファイル構成

### 作成されたテストファイル 🔵

テストファイルは `/frontend/kotonoha_app/integration_test/device_test/` に配置されています。

| ファイル名 | テスト内容 | テストケースID |
|-----------|----------|--------------|
| `device_basic_test.dart` | 基本動作テスト（RT-001〜RT-016） | RT-001〜RT-016 |
| `orientation_test.dart` | 画面方向対応テスト（RT-101〜RT-103） | RT-101〜RT-103 |
| `tablet_layout_test.dart` | タブレット表示テスト（RT-104〜RT-107） | RT-104〜RT-107 |
| `tts_device_test.dart` | TTS実機動作テスト（RT-201〜RT-206、RT-301〜RT-307） | RT-201〜RT-206、RT-301〜RT-307 |

---

## 基本動作テストケース

### テストファイル: `device_basic_test.dart`

iOS/Android実機での基本機能動作を検証します。

| テストID | テスト項目 | 関連要件 | 信頼性 | 目的 | 手順 | 期待結果 | iOS | Android |
|---------|----------|---------|--------|------|------|---------|-----|---------|
| **RT-001** | アプリ起動 | NFR-401 | 🔵 | iOS/Android実機でアプリが正常に起動することを確認 | ホーム画面からアプリアイコンをタップ | アプリが起動し、文字盤画面が表示される | ☐ | ☐ |
| **RT-002** | 文字盤タップ入力 | NFR-003 | 🔵 | 文字盤タップの応答性能を確認 | 「あ」ボタンをタップ | 入力欄に「あ」が表示される、100ms以内 | ☐ | ☐ |
| **RT-003** | TTS読み上げ | NFR-001、REQ-401 | 🔵 | TTS読み上げ開始時間を確認 | 「こんにちは」と入力し、読み上げボタンタップ | 1秒以内に「こんにちは」が読み上げられる | ☐ | ☐ |
| **RT-004** | TTS速度変更 | REQ-404 | 🔵 | TTS速度変更機能を確認 | 設定で速度「遅い」→「速い」に変更 | 読み上げ速度が変更される | ☐ | ☐ |
| **RT-005** | TTS停止 | REQ-403 | 🔵 | TTS停止機能を確認 | 読み上げ中に停止ボタンタップ | 読み上げが即座に停止する | ☐ | ☐ |
| **RT-006** | 定型文選択 | REQ-101〜REQ-107 | 🔵 | 定型文機能を確認 | 定型文「ありがとう」タップ | 即座に「ありがとう」が読み上げられる | ☐ | ☐ |
| **RT-007** | 大ボタンタップ | REQ-201〜REQ-208 | 🔵 | 大ボタン機能を確認 | 「はい」ボタンタップ | 「はい」が即座に読み上げられる | ☐ | ☐ |
| **RT-008** | 緊急ボタン | REQ-301〜REQ-307 | 🔵 | 緊急ボタン機能を確認 | 緊急ボタンを2回タップ（確認ダイアログ→「はい」） | 緊急音が鳴り、画面が赤表示される | ☐ | ☐ |
| **RT-009** | 履歴保存・再生 | REQ-601〜REQ-605 | 🔵 | 履歴機能を確認 | 読み上げ実行→履歴画面→履歴タップ | 履歴が保存され、再読み上げされる | ☐ | ☐ |
| **RT-010** | お気に入り登録 | REQ-701〜REQ-704 | 🔵 | お気に入り機能を確認 | 履歴からお気に入り登録 | お気に入り一覧に表示される | ☐ | ☐ |
| **RT-011** | AI変換 | REQ-901〜REQ-904、NFR-002 | 🔵 | AI変換機能を確認 | 「おはよう」入力→AI変換ボタン→丁寧「普通」 | 「おはようございます」が表示される、3秒以内 | ☐ | ☐ |
| **RT-012** | オフライン動作 | NFR-101 | 🔵 | オフライン動作を確認 | 機内モード→文字入力→読み上げ | 文字盤・TTS・定型文が正常動作する | ☐ | ☐ |
| **RT-013** | フォントサイズ変更 | REQ-801 | 🔵 | フォントサイズ変更機能を確認 | 設定でフォントサイズ「大」に変更 | 文字盤・定型文・ボタンラベルが大きく表示される | ☐ | ☐ |
| **RT-014** | テーマ変更 | REQ-802 | 🔵 | テーマ変更機能を確認 | 設定でテーマ「ダークモード」に変更 | 全画面がダークテーマに変更される | ☐ | ☐ |
| **RT-015** | 高コントラストモード | REQ-5006 | 🔵 | 高コントラストモード機能を確認 | 設定でテーマ「高コントラスト」に変更 | コントラスト比4.5:1以上で表示される | ☐ | ☐ |
| **RT-016** | 対面表示モード | REQ-501〜REQ-503 | 🔵 | 対面表示モード機能を確認 | 対面表示ボタンタップ | 画面が180度回転し、テキストが大きく表示される | ☐ | ☐ |

### 実行方法

```bash
# iOS実機で実行
flutter test integration_test/device_test/device_basic_test.dart -d <iOS_DEVICE_ID>

# Android実機で実行
flutter test integration_test/device_test/device_basic_test.dart -d <ANDROID_DEVICE_ID>
```

---

## 画面方向対応テストケース

### テストファイル: `orientation_test.dart`

縦向き・横向き両対応を検証します。

| テストID | テスト項目 | 関連要件 | 信頼性 | 目的 | 手順 | 期待結果 | iOS | Android |
|---------|----------|---------|--------|------|------|---------|-----|---------|
| **RT-101** | 縦向き表示 | NFR-403 | 🔵 | 縦向き表示が正常に機能することを確認 | デバイスを縦向きにする | レイアウトが縦向きに最適化される | ☐ | ☐ |
| **RT-102** | 横向き表示 | NFR-403 | 🔵 | 横向き表示が正常に機能することを確認 | デバイスを横向きにする | レイアウトが横向きに最適化される | ☐ | ☐ |
| **RT-103** | 画面回転時の状態保持 | NFR-403 | 🔵 | 画面回転時の状態保持を確認 | 入力中にデバイスを回転 | 入力内容が保持される | ☐ | ☐ |

### 詳細なテストシナリオ 🟡

#### RT-101: 縦向き表示テスト

**テスト内容**:
- デバイスを縦向き（Portrait）にする
- 文字盤ボタンの配置が縦向きに最適化される
- 定型文一覧のカラム数が縦向きに調整される（例: 1列）
- 大ボタン・緊急ボタンが常に視認可能な位置に配置される

**確認項目**:
- [ ] 文字盤が縦向きレイアウトで表示される
- [ ] ボタンが44px × 44px以上のサイズで表示される
- [ ] レイアウトが崩れない

#### RT-102: 横向き表示テスト

**テスト内容**:
- デバイスを横向き（Landscape）にする
- 文字盤ボタンの配置が横向きに最適化される
- 定型文一覧のカラム数が横向きに調整される（例: 2-3列）
- タブレット利用時に推奨される表示モード

**確認項目**:
- [ ] 文字盤が横向きレイアウトで表示される
- [ ] 定型文が横向きで複数列表示される
- [ ] レイアウトが崩れない

#### RT-103: 画面回転時の状態保持テスト

**テスト内容**:
- 縦向きで文字列を入力（例: 「画面回転テスト」）
- デバイスを横向きに回転
- 入力内容が保持されることを確認
- 再度縦向きに戻す
- 入力内容が引き続き保持されることを確認

**確認項目**:
- [ ] 画面回転後も入力内容が保持される
- [ ] 画面回転時にアプリがクラッシュしない
- [ ] 複数回回転しても状態が保持される

### 実行方法

```bash
# iOS実機で実行
flutter test integration_test/device_test/orientation_test.dart -d <iOS_DEVICE_ID>

# Android実機で実行
flutter test integration_test/device_test/orientation_test.dart -d <ANDROID_DEVICE_ID>
```

---

## タブレット表示テストケース

### テストファイル: `tablet_layout_test.dart`

9.7インチ以上タブレットでの最適表示を検証します。

| テストID | テスト項目 | 関連要件 | 信頼性 | 目的 | 手順 | 期待結果 | iOS | Android |
|---------|----------|---------|--------|------|------|---------|-----|---------|
| **RT-104** | タブレット表示（9.7インチ以上） | NFR-402 | 🔵 | タブレットでの最適表示を確認 | iPad/タブレットで起動 | 文字盤・定型文が見やすく表示される | ☐ | ☐ |
| **RT-105** | スマートフォン表示 | NFR-402 | 🟡 | スマートフォンでの基本動作を確認 | iPhone/スマホで起動 | 基本機能が動作する（最適化は期待しない） | ☐ | ☐ |
| **RT-106** | タップターゲットサイズ | REQ-5001、NFR-202 | 🔵 | タップターゲットサイズの要件を確認 | 文字盤ボタンのサイズ確認 | 44px × 44px以上 | ☐ | ☐ |
| **RT-107** | 大ボタンサイズ | NFR-202 | 🔵 | 大ボタンサイズの要件を確認 | 大ボタン・緊急ボタンのサイズ確認 | 60px × 60px以上（推奨） | ☐ | ☐ |

### 詳細なテストシナリオ 🔵

#### RT-104: タブレット表示テスト

**テスト内容**:
- iPad（10.2インチ）またはAndroidタブレット（10.4インチ）で起動
- 縦向き・横向き両方で表示を確認
- 文字盤ボタン・定型文が見やすく配置される
- タブレット横向きで定型文が複数列（2-3列）で表示される

**確認項目**:
- [ ] タブレット縦向きで文字盤が見やすく表示される
- [ ] タブレット横向きで定型文が複数列で表示される
- [ ] ボタン配置が適切で誤タップしにくい

#### RT-105: スマートフォン表示テスト

**テスト内容**:
- iPhone（5.4〜6.1インチ）またはAndroidスマートフォンで起動
- 基本機能（文字盤、TTS、定型文）が動作することを確認
- レイアウトが崩れないことを確認（最適化は期待しない）

**確認項目**:
- [ ] スマートフォンで文字盤が表示される
- [ ] 基本機能が動作する
- [ ] 主要ボタンがタップ可能

#### RT-106: タップターゲットサイズテスト

**テスト内容**:
- 文字盤の「あ」ボタンのサイズを測定
- タブレット、スマートフォン両方で確認
- 44px × 44px以上であることを検証（REQ-5001）

**確認項目**:
- [ ] 文字盤ボタンの幅が44px以上
- [ ] 文字盤ボタンの高さが44px以上
- [ ] スマートフォンでも要件を満たす

#### RT-107: 大ボタンサイズテスト

**テスト内容**:
- 大ボタン「はい」「いいえ」「わからない」のサイズを測定
- 緊急ボタンのサイズを測定
- 44px × 44px以上（必須）、60px × 60px以上（推奨）であることを検証

**確認項目**:
- [ ] 大ボタンの幅が44px以上（必須）
- [ ] 大ボタンの高さが44px以上（必須）
- [ ] 推奨サイズ（60px × 60px）を満たすか確認（警告表示）

### 実行方法

```bash
# iOS実機（iPad）で実行
flutter test integration_test/device_test/tablet_layout_test.dart -d <iPad_DEVICE_ID>

# Android実機（タブレット）で実行
flutter test integration_test/device_test/tablet_layout_test.dart -d <ANDROID_TABLET_DEVICE_ID>
```

---

## TTS実機動作テストケース

### テストファイル: `tts_device_test.dart`

TTS（Text-to-Speech）機能の実機動作を検証します。

### プラットフォーム固有テストケース 🔵

| テストID | テスト項目 | 関連要件 | 信頼性 | 目的 | 手順 | 期待結果 | iOS | Android |
|---------|----------|---------|--------|------|------|---------|-----|---------|
| **RT-201** | iOS TTS（AVSpeechSynthesizer） | REQ-401 | 🔵 | iOS固有のTTS実装を確認 | iOS実機で読み上げ | 日本語音声エンジンで読み上げられる | ☐ | N/A |
| **RT-202** | iOS SafeArea | NFR-205 | 🔵 | iOS SafeArea対応を確認 | iPhone（ノッチあり）で起動 | レイアウトがSafeArea内に収まる | ☐ | N/A |
| **RT-203** | iOS ガイド付きアクセス | NFR-205 | 🔵 | iOSガイド付きアクセス対応を確認 | ガイド付きアクセス有効化 | アプリが正常動作する | ☐ | N/A |
| **RT-204** | Android TTS（TextToSpeech） | REQ-401 | 🔵 | Android固有のTTS実装を確認 | Android実機で読み上げ | 日本語音声エンジンで読み上げられる | N/A | ☐ |
| **RT-205** | Android Navigation Bar | NFR-205 | 🔵 | Android Navigation Bar対応を確認 | 3ボタン/ジェスチャーナビゲーション | レイアウトが適切に調整される | N/A | ☐ |
| **RT-206** | Android 画面ピン留め | NFR-205 | 🔵 | Android画面ピン留め対応を確認 | 画面ピン留め有効化 | アプリが正常動作する | N/A | ☐ |

### 詳細なテストシナリオ（プラットフォーム固有）

#### RT-201: iOS TTS（AVSpeechSynthesizer）テスト

**テスト内容**:
- iOS実機で日本語テキストを入力
- 読み上げボタンをタップ
- AVSpeechSynthesizerが使用されている
- 日本語音声エンジンで読み上げられる
- 音声がクリアで聞き取りやすい

**確認項目**:
- [ ] iOS実機でTTSが正常動作する
- [ ] 1秒以内に読み上げが開始される（NFR-001）
- [ ] 日本語音声エンジンが使用される
- [ ] 音声品質が良好

#### RT-202: iOS SafeAreaテスト

**テスト内容**:
- iPhone 12以降（ノッチあり）で起動
- レイアウトがノッチやホームインジケーターと重ならない
- 文字盤ボタンが画面端まで適切に配置される

**確認項目**:
- [ ] レイアウトがノッチと重ならない
- [ ] レイアウトがホームインジケーターと重ならない
- [ ] SafeArea内にレイアウトが収まる

#### RT-203: iOSガイド付きアクセステスト

**テスト内容**:
1. 設定 > アクセシビリティ > ガイドアクセス を有効化
2. アプリ起動後、ホームボタン3回押し（または電源ボタン3回押し）
3. ガイド付きアクセスを開始
4. アプリの基本機能（文字盤、TTS、定型文）が正常動作することを確認
5. アプリからの脱出ができないことを確認（セキュリティ）

**確認項目**:
- [ ] ガイド付きアクセス有効時もアプリが正常動作する
- [ ] 文字盤・TTS・定型文が動作する
- [ ] アプリからの脱出ができない（意図した動作）

#### RT-204: Android TTS（TextToSpeech）テスト

**テスト内容**:
- Android実機で日本語テキストを入力
- 読み上げボタンをタップ
- TextToSpeechが使用されている
- 日本語音声エンジン（Google TTS等）で読み上げられる
- 音声がクリアで聞き取りやすい

**確認項目**:
- [ ] Android実機でTTSが正常動作する
- [ ] 1秒以内に読み上げが開始される（NFR-001）
- [ ] 日本語音声エンジンが使用される
- [ ] 音声品質が良好

#### RT-205: Android Navigation Barテスト

**テスト内容**:
- 3ボタンナビゲーション有効時にレイアウトが適切に調整される
- ジェスチャーナビゲーション有効時にレイアウトが適切に調整される
- Navigation Barと重ならない

**確認項目**:
- [ ] 3ボタンナビゲーション時にレイアウトが適切
- [ ] ジェスチャーナビゲーション時にレイアウトが適切
- [ ] Navigation Barと重ならない

#### RT-206: Android画面ピン留めテスト

**テスト内容**:
1. 設定 > セキュリティ > 画面の固定 を有効化
2. アプリ起動後、最近使ったアプリボタンをタップ
3. アプリカードの上部にあるピンアイコンをタップ
4. 画面ピン留めを開始
5. アプリの基本機能（文字盤、TTS、定型文）が正常動作することを確認
6. 戻る+最近使ったアプリボタン長押しでピン留め解除できることを確認

**確認項目**:
- [ ] 画面ピン留め有効時もアプリが正常動作する
- [ ] 文字盤・TTS・定型文が動作する
- [ ] ピン留め解除が正常に機能する

---

## エッジケース・エラーハンドリングテストケース

### テストファイル: `tts_device_test.dart`

| テストID | テスト項目 | 関連要件 | 信頼性 | 目的 | 手順 | 期待結果 | iOS | Android |
|---------|----------|---------|--------|------|------|---------|-----|---------|
| **RT-301** | OS音量0での読み上げ | EDGE-202 | 🟡 | 音量0での読み上げエラーハンドリングを確認 | 音量0→読み上げ実行 | 「音量が0です」視覚的警告表示 | ☐ | ☐ |
| **RT-302** | マナーモード時の緊急ボタン | EDGE-203 | 🟡 | マナーモード時の緊急ボタンエラーハンドリングを確認 | マナーモード→緊急ボタン | 明確な警告表示（音が鳴らない旨） | ☐ | ☐ |
| **RT-303** | TTS音声エンジン未インストール | EDGE-004 | 🟡 | TTS音声エンジン未インストール時のエラーハンドリングを確認 | 日本語音声エンジンを削除（可能なら） | エラーメッセージ表示、テキスト表示のみ継続 | ☐ | ☐ |
| **RT-304** | バックグラウンド復帰 | EDGE-201 | 🟡 | バックグラウンド復帰時の状態復元を確認 | アプリをバックグラウンドに→復帰 | 前回の画面状態・入力内容が復元される | ☐ | ☐ |
| **RT-305** | 長文読み上げ | TTS確認項目 | 🟡 | 長文読み上げの安定性を確認 | 500文字以上の長文を読み上げ | 安定して読み上げられる、途中で停止しない | ☐ | ☐ |
| **RT-306** | 連続読み上げ | TTS確認項目 | 🟡 | 連続読み上げの安定性を確認 | 10回連続で読み上げ実行 | 安定して読み上げられる、メモリリークなし | ☐ | ☐ |
| **RT-307** | ストレージ容量不足 | EDGE-003 | 🟡 | ストレージ容量不足時のエラーハンドリングを確認 | デバイスのストレージを極限まで埋める | 警告表示、古い履歴削除提案 | ☐ | ☐ |

### 詳細なテストシナリオ（エッジケース）

#### RT-301: OS音量0での読み上げテスト

**テスト内容**:
1. OS音量を0（ミュート）に設定
2. 読み上げボタンをタップ
3. 「音量が0です。音量を上げてください」などの視覚的警告が表示される
4. スナックバーまたはダイアログで通知される

**確認項目**:
- [ ] 音量0時に視覚的警告が表示される
- [ ] スナックバーまたはダイアログで通知される
- [ ] アプリがクラッシュしない

#### RT-302: マナーモード時の緊急ボタンテスト

**テスト内容**:
1. デバイスをマナーモードに設定
2. 緊急ボタンを押下
3. 「マナーモードのため音が鳴りません」などの警告が表示される
4. 視覚的な警告（画面赤表示、テキスト表示）は正常動作する

**確認項目**:
- [ ] マナーモード時に明確な警告が表示される
- [ ] 視覚的な警告は正常動作する
- [ ] アプリがクラッシュしない

#### RT-303: TTS音声エンジン未インストールテスト

**テスト内容**:
1. iOS: 設定 > アクセシビリティ > 読み上げコンテンツ > 声 で日本語音声を削除
2. Android: 設定 > システム > 言語と入力 > テキスト読み上げ で音声エンジンをアンインストール
3. 読み上げボタンをタップ
4. 「音声エンジンがインストールされていません」などのエラーメッセージが表示される
5. テキスト表示は継続され、アプリがクラッシュしない

**確認項目**:
- [ ] 音声エンジン未インストール時に適切なエラー表示
- [ ] テキスト表示は継続される
- [ ] アプリがクラッシュしない

#### RT-304: バックグラウンド復帰テスト

**テスト内容**:
1. 文字列を入力した状態でホームボタン（またはジェスチャー）でバックグラウンドに移行
2. 他のアプリを開く（メモリプレッシャーをかける）
3. アプリを再度開く
4. 入力内容が保持されている
5. 画面状態（選択中のタブ、スクロール位置等）が復元される

**確認項目**:
- [ ] バックグラウンド復帰時に状態が復元される
- [ ] 入力内容が保持される
- [ ] 画面状態が復元される

#### RT-305: 長文読み上げテスト

**テスト内容**:
1. 500文字以上の長文を入力
2. 読み上げボタンをタップ
3. 最後まで安定して読み上げられる
4. 途中で停止しない
5. メモリリークが発生しない

**確認項目**:
- [ ] 長文読み上げが安定動作する
- [ ] 途中で停止しない
- [ ] メモリリークが発生しない

#### RT-306: 連続読み上げテスト

**テスト内容**:
1. 文字列を入力
2. 読み上げボタンを10回連続でタップ
3. すべて安定して読み上げられる
4. メモリリークが発生しない
5. アプリがクラッシュしない

**確認項目**:
- [ ] 連続読み上げが安定動作する
- [ ] メモリリークが発生しない
- [ ] アプリがクラッシュしない

#### RT-307: ストレージ容量不足テスト

**テスト内容**:
1. デバイスのストレージを限界まで埋める
2. アプリで履歴を大量に保存
3. ストレージ容量不足の警告が表示される
4. 「古い履歴を削除しますか?」などの提案が表示される
5. 自動的に古い履歴が削除される（50件制限）

**確認項目**:
- [ ] ストレージ容量不足時に適切な警告が表示される
- [ ] 古い履歴削除提案が表示される
- [ ] 50件制限が機能する

### 実行方法

```bash
# iOS実機で実行（プラットフォーム固有テスト）
flutter test integration_test/device_test/tts_device_test.dart -d <iOS_DEVICE_ID>

# Android実機で実行（プラットフォーム固有テスト）
flutter test integration_test/device_test/tts_device_test.dart -d <ANDROID_DEVICE_ID>
```

**注意**: プラットフォーム固有テスト（RT-201〜RT-206）は、該当するプラットフォームでのみ実行可能です。iOS固有テストはiOS実機で、Android固有テストはAndroid実機で実行してください。

---

## テスト実行方法

### 前提条件 🔵

1. **実機の準備**:
   - iOS実機（iPhone/iPad）がUSB接続されている
   - Android実機（スマートフォン/タブレット）がUSB接続されている
   - デバイスが開発者モードになっている

2. **ビルド配布**（オプション）:
   - iOS: TestFlight経由でビルドを配布
   - Android: Google Play Console 内部テスト経由でビルドを配布

### 実行コマンド 🔵

#### すべてのデバイステストを実行

```bash
# すべてのデバイステストを実行（iOS/Android）
flutter test integration_test/device_test/ -d <DEVICE_ID>
```

#### 個別のテストファイルを実行

```bash
# 基本動作テスト
flutter test integration_test/device_test/device_basic_test.dart -d <DEVICE_ID>

# 画面方向対応テスト
flutter test integration_test/device_test/orientation_test.dart -d <DEVICE_ID>

# タブレット表示テスト
flutter test integration_test/device_test/tablet_layout_test.dart -d <DEVICE_ID>

# TTS実機動作テスト
flutter test integration_test/device_test/tts_device_test.dart -d <DEVICE_ID>
```

#### デバイスIDの確認

```bash
# 接続されているデバイスを確認
flutter devices

# 出力例:
# Found 2 connected devices:
#   iPhone 14 (mobile)             • 00008110-XXXXXXXXXXXX • ios            • iOS 16.0
#   Pixel 5 (mobile)               • ABCD1234EFGH5678      • android-arm64 • Android 13 (API 33)
```

### スクリーンショット取得 🟡

各テストではスクリーンショットが自動的に取得されます。スクリーンショットは以下のディレクトリに保存されます:

```
build/app/outputs/integration_test_screenshots/
```

### テスト結果の確認 🟡

テスト実行後、以下の情報を確認してください:

1. **テスト成功/失敗**:
   - すべてのテストケースが成功したことを確認
   - 失敗したテストケースのエラーメッセージを確認

2. **スクリーンショット**:
   - 各テストのスクリーンショットを確認
   - レイアウトが正しく表示されているか確認

3. **パフォーマンス計測結果**:
   - TTS読み上げ開始時間（1秒以内）
   - 文字盤タップ応答時間（100ms以内）

---

## 受け入れ基準

### 基本動作 🔵

- [ ] iOS実機（iPhone/iPad）でアプリが起動し、基本機能（文字盤・定型文・TTS）が正常動作する
- [ ] Android実機（スマートフォン/タブレット）でアプリが起動し、基本機能が正常動作する
- [ ] iOS 14.0以上、Android 10以上で動作する（NFR-401）
- [ ] 基本動作テストケース（RT-001〜RT-016）がすべて完了し、iOS/Android両方で✓がつく

### TTS実機動作 🔵

- [ ] iOS実機でTTS読み上げが1秒以内に開始される（NFR-001）
- [ ] Android実機でTTS読み上げが1秒以内に開始される（NFR-001）
- [ ] TTS速度変更（遅い/普通/速い）が実機で正常動作する
- [ ] TTS停止・中断が実機で正常動作する

### タブレット最適表示 🔵

- [ ] 9.7インチ以上のタブレット（iPad/Android）で最適な表示がされる（NFR-402）
- [ ] 文字盤ボタン・定型文一覧が見やすく配置される
- [ ] タップターゲットサイズが44px × 44px以上（REQ-5001）、大ボタンは60px × 60px以上（NFR-202）
- [ ] タブレット表示テストケース（RT-104〜RT-107）がすべて完了

### 画面方向対応 🔵

- [ ] 縦向き（Portrait）表示が正常に機能する（NFR-403）
- [ ] 横向き（Landscape）表示が正常に機能する（NFR-403）
- [ ] 画面回転時にレイアウトが自動調整される
- [ ] 画面回転時にユーザー入力状態が保持される
- [ ] 画面方向対応テストケース（RT-101〜RT-103）がすべて完了

### プラットフォーム固有機能 🟡

- [ ] iOS SafeArea（ノッチ、ホームインジケーター）に対応したレイアウト
- [ ] Android Navigation Bar（3ボタン/ジェスチャー）に対応したレイアウト
- [ ] iOSガイド付きアクセス設定方法がアプリ内ヘルプに記載され、動作確認済み（NFR-205）
- [ ] Android画面ピン留め設定方法がアプリ内ヘルプに記載され、動作確認済み（NFR-205）
- [ ] プラットフォーム固有テストケース（RT-201〜RT-206）が主要項目で完了

### エラーハンドリング 🟡

- [ ] OS音量0での読み上げ実行時に視覚的警告が表示される（EDGE-202）
- [ ] マナーモード時の緊急ボタン押下で明確な警告が表示される（EDGE-203）
- [ ] バックグラウンド復帰時に前回の状態が復元される（EDGE-201）
- [ ] TTS音声エンジン未インストール時にエラーメッセージが表示される（EDGE-004）
- [ ] エッジケーステストケース（RT-301〜RT-307）が主要項目で完了

### テストカバレッジ 🟡

- [ ] 基本動作テストケース（RT-001〜RT-016）がすべて完了し、iOS/Android両方で✓がつく
- [ ] 画面方向対応テストケース（RT-101〜RT-103）がすべて完了
- [ ] タブレット表示テストケース（RT-104〜RT-107）がすべて完了
- [ ] プラットフォーム固有テストケース（RT-201〜RT-206）がすべて完了
- [ ] エッジケーステストケース（RT-301〜RT-307）が主要項目で完了

---

## テスト結果レポート

テスト完了後、以下の情報を含むレポートを作成してください:

### レポートテンプレート

```markdown
# TASK-0095 実機テスト結果レポート

## テスト実施情報

- **テスト実施日時**: YYYY-MM-DD HH:MM
- **テスト実施者**: [担当者名]
- **テスト環境**: iOS/Android実機

## テスト対象デバイス一覧

### iOS実機

| デバイス名 | OSバージョン | 画面サイズ | テスト結果 |
|-----------|------------|----------|----------|
| iPhone 14 | iOS 16.0 | 6.1インチ | ✅ PASS |
| iPad (第7世代) | iOS 16.0 | 10.2インチ | ✅ PASS |

### Android実機

| デバイス名 | OSバージョン | 画面サイズ | テスト結果 |
|-----------|------------|----------|----------|
| Pixel 5 | Android 13 | 6.0インチ | ✅ PASS |
| Galaxy Tab A7 | Android 12 | 10.4インチ | ✅ PASS |

## テストケース完了状況

### 基本動作テストケース（RT-001〜RT-016）

| テストID | iOS | Android | 備考 |
|---------|-----|---------|------|
| RT-001 | ✅ | ✅ | |
| RT-002 | ✅ | ✅ | |
| ... | | | |

### 画面方向対応テストケース（RT-101〜RT-103）

| テストID | iOS | Android | 備考 |
|---------|-----|---------|------|
| RT-101 | ✅ | ✅ | |
| ... | | | |

### タブレット表示テストケース（RT-104〜RT-107）

| テストID | iOS | Android | 備考 |
|---------|-----|---------|------|
| RT-104 | ✅ | ✅ | |
| ... | | | |

### プラットフォーム固有テストケース（RT-201〜RT-206）

| テストID | iOS | Android | 備考 |
|---------|-----|---------|------|
| RT-201 | ✅ | N/A | |
| RT-204 | N/A | ✅ | |
| ... | | | |

### エッジケーステストケース（RT-301〜RT-307）

| テストID | iOS | Android | 備考 |
|---------|-----|---------|------|
| RT-301 | ✅ | ✅ | |
| ... | | | |

## 発見した問題一覧

| Issue番号 | 問題内容 | 再現手順 | 優先度 | ステータス |
|----------|---------|---------|--------|----------|
| #123 | [問題内容] | [再現手順] | High/Medium/Low | Open/Closed |

## 総合評価

- **iOS実機での動作**: ✅ 正常動作 / ⚠️ 軽微な問題あり / ❌ 重大な問題あり
- **Android実機での動作**: ✅ 正常動作 / ⚠️ 軽微な問題あり / ❌ 重大な問題あり
- **リリース可否**: ✅ リリース可能 / ⚠️ 修正後リリース可能 / ❌ リリース不可

## 備考

[その他の気づき、コメント等]
```

---

## 関連ドキュメント

- [要件定義書](kotonoha-requirements.md)
- [Phase 5 タスク](../../../tasks/kotonoha-phase5.md)
- [TASK-0091: iOSビルド設定](../TASK-0091/)
- [TASK-0092: Androidビルド設定](../TASK-0092/)
- [TASK-0088: パフォーマンス計測・プロファイリング](../TASK-0088/)

---

## 更新履歴

- **2025-12-02**: 初回作成（テストケース定義書作成）
