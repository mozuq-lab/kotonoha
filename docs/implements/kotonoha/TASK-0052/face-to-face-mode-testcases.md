# 対面表示モード（拡大表示）テストケース一覧

## TASK-0052: 対面表示モード（拡大表示）実装

**作成日**: 2025-11-26
**テスト対象**: 対面表示モード機能（FaceToFace）
**関連要件**: REQ-501, REQ-503
**テストフレームワーク**: flutter_test + mocktail

---

## 開発言語・フレームワーク

- **プログラミング言語**: Dart 3.5+
  - **言語選択の理由**: Flutter プロジェクトの標準言語
  - **テストに適した機能**: null safety、非同期テスト対応
- **テストフレームワーク**: flutter_test + mocktail
  - **フレームワーク選択の理由**: Flutter公式推奨 + 既存プロジェクトでの使用実績
  - **テスト実行環境**: `flutter test` コマンド
- 🔵 青信号: CLAUDE.md の技術スタック定義に基づく

---

## テストケース分類

### 1. FaceToFaceState（状態モデル）テスト

| ID | テスト名 | 優先度 | 信頼性 |
|----|---------|--------|--------|
| TC-052-001 | 初期状態でisEnabledがfalse | P0 | 🔵 |
| TC-052-002 | 初期状態でdisplayTextが空文字列 | P0 | 🔵 |
| TC-052-003 | copyWithでisEnabledを更新できる | P0 | 🔵 |
| TC-052-004 | copyWithでdisplayTextを更新できる | P0 | 🔵 |

### 2. FaceToFaceNotifier（状態管理）テスト

| ID | テスト名 | 優先度 | 信頼性 |
|----|---------|--------|--------|
| TC-052-005 | enableFaceToFaceでモードが有効化される | P0 | 🔵 |
| TC-052-006 | enableFaceToFaceでテキストが設定される | P0 | 🔵 |
| TC-052-007 | disableFaceToFaceでモードが無効化される | P0 | 🔵 |
| TC-052-008 | disableFaceToFaceでテキストがクリアされる | P1 | 🟡 |
| TC-052-009 | updateTextで表示テキストが更新される | P0 | 🔵 |

### 3. FaceToFaceScreen（画面）テスト

| ID | テスト名 | 優先度 | 信頼性 |
|----|---------|--------|--------|
| TC-052-010 | 対面表示画面でテキストが大きく表示される | P0 | 🔵 |
| TC-052-011 | テキストが画面中央に配置される | P0 | 🔵 |
| TC-052-012 | 背景がシンプルな単色で表示される | P1 | 🟡 |
| TC-052-013 | 戻るボタンが表示される | P0 | 🔵 |
| TC-052-014 | 戻るボタンタップで通常モードに戻る | P0 | 🔵 |
| TC-052-015 | 戻るボタンのサイズが44px×44px以上 | P0 | 🔵 |

### 4. FaceToFaceToggleButton（切り替えボタン）テスト

| ID | テスト名 | 優先度 | 信頼性 |
|----|---------|--------|--------|
| TC-052-016 | 切り替えボタンが表示される | P0 | 🔵 |
| TC-052-017 | ボタンタップで対面表示モードに切り替わる | P0 | 🔵 |
| TC-052-018 | ボタンのサイズが44px×44px以上 | P0 | 🔵 |
| TC-052-019 | テキスト空の場合はボタン無効化（または警告表示） | P1 | 🟡 |

### 5. FaceToFaceTextDisplay（拡大テキスト表示）テスト

| ID | テスト名 | 優先度 | 信頼性 |
|----|---------|--------|--------|
| TC-052-020 | テキストが通常より大きいフォントで表示される | P0 | 🔵 |
| TC-052-021 | 長いテキストがスクロール可能 | P1 | 🟡 |
| TC-052-022 | テキストが空の場合「テキストがありません」表示 | P1 | 🟡 |

### 6. アクセシビリティテスト

| ID | テスト名 | 優先度 | 信頼性 |
|----|---------|--------|--------|
| TC-052-023 | Semanticsラベルが設定されている | P1 | 🟡 |
| TC-052-024 | ライトテーマで適切に表示される | P1 | 🔵 |
| TC-052-025 | ダークテーマで適切に表示される | P1 | 🔵 |
| TC-052-026 | 高コントラストテーマで適切に表示される | P1 | 🔵 |

### 7. 境界値テスト

| ID | テスト名 | 優先度 | 信頼性 |
|----|---------|--------|--------|
| TC-052-027 | 1000文字のテキストが表示される | P0 | 🔵 |
| TC-052-028 | 1文字のテキストが表示される | P1 | 🟡 |
| TC-052-029 | 改行を含むテキストが正しく表示される | P1 | 🟡 |

---

## テストケース詳細

### 1. 正常系テストケース（基本的な動作）

#### TC-052-001: 初期状態でisEnabledがfalse 🔵

- **テスト名**: 初期状態でisEnabledがfalse
  - **何をテストするか**: FaceToFaceStateの初期状態
  - **期待される動作**: アプリ起動時は対面表示モードが無効
- **入力値**: なし（デフォルトコンストラクタ）
  - **入力データの意味**: 初期状態の確認
- **期待される結果**: `isEnabled == false`
  - **期待結果の理由**: 通常モードがデフォルト（REQ-503）
- **テストの目的**: 初期状態の正確性確認
  - **確認ポイント**: デフォルト値が正しいこと
- 🔵 青信号: REQ-503「シンプルな操作で切り替え」から、デフォルトは通常モード

#### TC-052-005: enableFaceToFaceでモードが有効化される 🔵

- **テスト名**: enableFaceToFaceでモードが有効化される
  - **何をテストするか**: 対面表示モード有効化処理
  - **期待される動作**: enableFaceToFace呼び出しでisEnabled=trueになる
- **入力値**: `enableFaceToFace("お水をください")`
  - **入力データの意味**: 表示したいテキストを渡してモード有効化
- **期待される結果**: `state.isEnabled == true`, `state.displayText == "お水をください"`
  - **期待結果の理由**: モード切り替え（REQ-503）とテキスト表示（REQ-501）
- **テストの目的**: モード切り替え機能の確認
  - **確認ポイント**: 状態が正しく更新されること
- 🔵 青信号: REQ-501, REQ-503に基づく

#### TC-052-010: 対面表示画面でテキストが大きく表示される 🔵

- **テスト名**: 対面表示画面でテキストが大きく表示される
  - **何をテストするか**: 対面表示画面のUI表示
  - **期待される動作**: テキストが通常より大きいフォントで表示される
- **入力値**: `displayText = "こんにちは"`
  - **入力データの意味**: 表示するテキスト
- **期待される結果**: テキストウィジェットが存在し、フォントサイズが大きい
  - **期待結果の理由**: REQ-501「テキストを画面中央に大きく表示」
- **テストの目的**: 拡大表示の実装確認
  - **確認ポイント**: フォントサイズが通常より大きいこと
- 🔵 青信号: REQ-501に基づく

#### TC-052-014: 戻るボタンタップで通常モードに戻る 🔵

- **テスト名**: 戻るボタンタップで通常モードに戻る
  - **何をテストするか**: 通常モードへの復帰機能
  - **期待される動作**: 戻るボタンタップでisEnabled=falseになる
- **入力値**: 戻るボタンのタップイベント
  - **入力データの意味**: ユーザーが通常モードに戻りたい場合
- **期待される結果**: `state.isEnabled == false`
  - **期待結果の理由**: REQ-503「シンプルな操作で切り替え」
- **テストの目的**: 復帰機能の確認
  - **確認ポイント**: 1タップで通常モードに戻ること
- 🔵 青信号: REQ-503に基づく

#### TC-052-017: ボタンタップで対面表示モードに切り替わる 🔵

- **テスト名**: ボタンタップで対面表示モードに切り替わる
  - **何をテストするか**: 切り替えボタンの機能
  - **期待される動作**: ボタンタップでモードが切り替わる
- **入力値**: 切り替えボタンのタップイベント
  - **入力データの意味**: ユーザーが対面表示に切り替えたい場合
- **期待される結果**: 対面表示画面に遷移
  - **期待結果の理由**: REQ-503「シンプルな操作で切り替え」
- **テストの目的**: 切り替え機能の確認
  - **確認ポイント**: 1タップで切り替わること
- 🔵 青信号: REQ-503に基づく

---

### 2. 異常系テストケース（エラーハンドリング）

#### TC-052-019: テキスト空の場合はボタン無効化（または警告表示） 🟡

- **テスト名**: テキスト空の場合はボタン無効化
  - **エラーケースの概要**: 表示するテキストがない状態での切り替え試行
  - **エラー処理の重要性**: 空の画面を表示しても意味がない
- **入力値**: `displayText = ""`（空文字列）
  - **不正な理由**: 対面表示する内容がない
  - **実際の発生シナリオ**: ユーザーが何も入力せずに対面表示を押す
- **期待される結果**: ボタンが無効化または「テキストがありません」表示
  - **エラーメッセージの内容**: 分かりやすい日本語
  - **システムの安全性**: エラー状態でもクラッシュしない
- **テストの目的**: 空テキスト時のUX確認
  - **品質保証の観点**: ユーザー混乱を防ぐ
- 🟡 黄信号: 要件定義書のエッジケースから推測

#### TC-052-022: テキストが空の場合「テキストがありません」表示 🟡

- **テスト名**: テキストが空の場合「テキストがありません」表示
  - **エラーケースの概要**: 対面表示画面で表示テキストが空
  - **エラー処理の重要性**: 空白画面よりメッセージ表示が親切
- **入力値**: `displayText = ""`
  - **不正な理由**: 空の対面表示画面
  - **実際の発生シナリオ**: 何らかの理由でテキストがクリアされた
- **期待される結果**: 「テキストがありません」メッセージ表示
  - **エラーメッセージの内容**: ユーザーに次のアクションを促す
  - **システムの安全性**: 正常な画面表示
- **テストの目的**: 空状態のUX確認
  - **品質保証の観点**: ユーザーフレンドリーなUI
- 🟡 黄信号: EDGE-103, EDGE-104の空状態パターンから推測

---

### 3. 境界値テストケース（最小値、最大値、null等）

#### TC-052-027: 1000文字のテキストが表示される 🔵

- **テスト名**: 1000文字のテキストが表示される
  - **境界値の意味**: 入力バッファの最大文字数
  - **境界値での動作保証**: 最大長でもクラッシュしない
- **入力値**: `displayText = 'あ' * 1000`
  - **境界値選択の根拠**: EDGE-101の1000文字制限
  - **実際の使用場面**: ユーザーが長い文章を入力した場合
- **期待される結果**: テキストが正常に表示される（スクロール可能）
  - **境界での正確性**: 全文字が表示可能
  - **一貫した動作**: 短いテキストと同様に動作
- **テストの目的**: 長文対応の確認
  - **堅牢性の確認**: 最大長でも安定動作
- 🔵 青信号: EDGE-101に基づく

#### TC-052-028: 1文字のテキストが表示される 🟡

- **テスト名**: 1文字のテキストが表示される
  - **境界値の意味**: 最小有効入力
  - **境界値での動作保証**: 最小でも正常表示
- **入力値**: `displayText = "あ"`
  - **境界値選択の根拠**: 1文字が最小有効入力
  - **実際の使用場面**: 「は」「い」などの短い返事
- **期待される結果**: テキストが画面中央に表示される
  - **境界での正確性**: 1文字でも見やすく表示
  - **一貫した動作**: 長いテキストと同様のレイアウト
- **テストの目的**: 短文対応の確認
  - **堅牢性の確認**: 最小長でも安定動作
- 🟡 黄信号: 境界値テストのベストプラクティスから推測

#### TC-052-029: 改行を含むテキストが正しく表示される 🟡

- **テスト名**: 改行を含むテキストが正しく表示される
  - **境界値の意味**: 特殊文字（改行）の処理
  - **境界値での動作保証**: 複数行テキストの表示
- **入力値**: `displayText = "こんにちは\nお元気ですか"`
  - **境界値選択の根拠**: 改行は一般的な入力パターン
  - **実際の使用場面**: 複数行のメッセージ
- **期待される結果**: 改行が正しく反映され、複数行で表示される
  - **境界での正確性**: 改行位置が正確
  - **一貫した動作**: 1行テキストと同様に動作
- **テストの目的**: 改行対応の確認
  - **堅牢性の確認**: 特殊文字でも安定動作
- 🟡 黄信号: 既存テスト（TC-048-017特殊文字）パターンから推測

---

### 4. アクセシビリティテストケース

#### TC-052-015: 戻るボタンのサイズが44px×44px以上 🔵

- **テスト名**: 戻るボタンのサイズが44px×44px以上
  - **何をテストするか**: アクセシビリティ要件の遵守
  - **期待される動作**: ボタンのタップ領域が十分なサイズ
- **入力値**: なし
  - **入力データの意味**: UI表示の確認
- **期待される結果**: ボタンサイズが44px×44px以上
  - **期待結果の理由**: REQ-5001「タップターゲット44px×44px以上」
- **テストの目的**: アクセシビリティ確認
  - **確認ポイント**: 運動機能に制約のあるユーザーでも操作可能
- 🔵 青信号: REQ-5001に基づく

#### TC-052-018: ボタンのサイズが44px×44px以上 🔵

- **テスト名**: 切り替えボタンのサイズが44px×44px以上
  - **何をテストするか**: アクセシビリティ要件の遵守
  - **期待される動作**: ボタンのタップ領域が十分なサイズ
- **入力値**: なし
  - **入力データの意味**: UI表示の確認
- **期待される結果**: ボタンサイズが44px×44px以上
  - **期待結果の理由**: REQ-5001「タップターゲット44px×44px以上」
- **テストの目的**: アクセシビリティ確認
  - **確認ポイント**: 運動機能に制約のあるユーザーでも操作可能
- 🔵 青信号: REQ-5001に基づく

---

## テストファイル構成

```
test/features/face_to_face/
├── domain/
│   └── models/
│       └── face_to_face_state_test.dart     # TC-052-001〜004
├── presentation/
│   ├── screens/
│   │   └── face_to_face_screen_test.dart    # TC-052-010〜015
│   └── widgets/
│       ├── face_to_face_text_display_test.dart  # TC-052-020〜022, 027〜029
│       └── face_to_face_toggle_button_test.dart # TC-052-016〜019
└── providers/
    └── face_to_face_provider_test.dart      # TC-052-005〜009, 023〜026
```

---

## 品質判定

### 判定結果: ✅ 高品質

| 基準 | 状態 |
|------|------|
| テストケース分類 | 正常系・異常系・境界値が網羅されている |
| 期待値定義 | 各テストケースの期待値が明確 |
| 技術選択 | Dart + flutter_test + mocktail（確定） |
| 実装可能性 | 既存パターン（TTS Provider等）で実現可能 |

### 信頼性レベルサマリー

- 🔵 青信号（確実）: 21件（72%）
  - REQ-501, REQ-503, REQ-5001に基づくテスト
- 🟡 黄信号（妥当な推測）: 8件（28%）
  - エッジケース、境界値の一部

### テストケース総数

- **合計**: 29件
- **P0（必須）**: 15件
- **P1（高優先度）**: 14件

---

## 次のステップ

`/tsumiki:tdd-red` でRedフェーズ（失敗テスト作成）を開始します。
