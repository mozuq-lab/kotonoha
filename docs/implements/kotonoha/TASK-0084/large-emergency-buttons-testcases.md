# TASK-0084: 大ボタン・緊急ボタンE2Eテスト - テストケース一覧

## タスク情報

- **タスクID**: TASK-0084
- **タスクタイプ**: TDD (E2Eテスト)
- **推定工数**: 8時間
- **関連要件**: REQ-201, REQ-202, REQ-203, REQ-204, REQ-301, REQ-302, REQ-303, REQ-304

## 開発言語・フレームワーク

- **プログラミング言語**: Dart
  - **言語選択の理由**: Flutterアプリケーションの開発言語
  - **テストに適した機能**: 型安全性、async/await対応
- **テストフレームワーク**: integration_test (Flutter)
  - **フレームワーク選択の理由**: Flutter公式E2Eテストフレームワーク
  - **テスト実行環境**: iOS/Android実機またはエミュレータ
- 🔵 信頼性レベル: 青信号 - 既存E2Eテスト（TASK-0082, TASK-0083）と同一構成

---

## 1. 正常系テストケース（大ボタン・クイック応答ボタン）

### TC-E2E-084-001: 「はい」「いいえ」「わからない」ボタンが表示される

- **テスト名**: クイック応答ボタン3種類の表示確認
  - **何をテストするか**: アプリ起動時に3つの大ボタンが画面上部に常時表示されること
  - **期待される動作**: 「はい」「いいえ」「わからない」のラベルを持つボタンが表示される
- **入力値**: なし（初期状態）
  - **入力データの意味**: 初回起動時のデフォルト状態を確認
- **期待される結果**: 3つのボタンがすべて表示される
  - **期待結果の理由**: REQ-201で「はい」「いいえ」「わからない」の3つを常時表示と規定
- **テストの目的**: 大ボタンの常時表示を確認（REQ-201準拠）
  - **確認ポイント**: ボタンラベルが正確、ボタンがタップ可能
- 🔵 信頼性レベル: 青信号 - REQ-201に基づく

### TC-E2E-084-002: 「はい」ボタンタップで即座に読み上げが開始される

- **テスト名**: 「はい」ボタン読み上げ開始確認
  - **何をテストするか**: 「はい」ボタンタップでTTS読み上げが開始されること
  - **期待される動作**: タップから1秒以内にTTS読み上げが開始される
- **入力値**: 「はい」ボタンのタップ
  - **入力データの意味**: ユーザーの肯定応答
- **期待される結果**: 停止ボタンが表示される（読み上げ中の証拠）
  - **期待結果の理由**: REQ-204でタップ時に即座読み上げを規定
- **テストの目的**: 大ボタン即座読み上げを確認（REQ-204、NFR-001準拠）
  - **確認ポイント**: 1秒以内の読み上げ開始
- 🔵 信頼性レベル: 青信号 - REQ-204、NFR-001に基づく

### TC-E2E-084-003: 「いいえ」ボタンタップで即座に読み上げが開始される

- **テスト名**: 「いいえ」ボタン読み上げ開始確認
  - **何をテストするか**: 「いいえ」ボタンタップでTTS読み上げが開始されること
  - **期待される動作**: タップから1秒以内にTTS読み上げが開始される
- **入力値**: 「いいえ」ボタンのタップ
  - **入力データの意味**: ユーザーの否定応答
- **期待される結果**: 停止ボタンが表示される
  - **期待結果の理由**: REQ-204準拠
- **テストの目的**: 複数ボタンの一貫した動作確認
  - **確認ポイント**: 「はい」と同様の動作
- 🔵 信頼性レベル: 青信号 - REQ-204に基づく

### TC-E2E-084-004: 「わからない」ボタンタップで即座に読み上げが開始される

- **テスト名**: 「わからない」ボタン読み上げ開始確認
  - **何をテストするか**: 「わからない」ボタンタップでTTS読み上げが開始されること
  - **期待される動作**: タップから1秒以内にTTS読み上げが開始される
- **入力値**: 「わからない」ボタンのタップ
  - **入力データの意味**: ユーザーの保留応答
- **期待される結果**: 停止ボタンが表示される
  - **期待結果の理由**: REQ-204準拠
- **テストの目的**: 3種類すべてのボタン動作確認
  - **確認ポイント**: すべてのボタンで一貫した動作
- 🔵 信頼性レベル: 青信号 - REQ-204に基づく

### TC-E2E-084-005: 大ボタン連続タップがデバウンスされる

- **テスト名**: 大ボタンデバウンス動作確認
  - **何をテストするか**: 連続タップが適切に処理されること（デバウンス機能）
  - **期待される動作**: 300ms以内の連続タップは1回として処理される
- **入力値**: 「はい」ボタンを300ms以内に2回連続タップ
  - **入力データの意味**: 誤操作シミュレーション
- **期待される結果**: 1回目のタップのみ処理される
  - **期待結果の理由**: デバウンス機能により誤操作を防止
- **テストの目的**: 誤操作防止機能の確認
  - **確認ポイント**: TTS読み上げが1回のみ開始される
- 🟡 信頼性レベル: 黄信号 - 実装（DebounceMixin）から推測

---

## 2. 正常系テストケース（状態ボタン）

### TC-E2E-084-006: 状態ボタンが8-12個表示される

- **テスト名**: 状態ボタン数の確認
  - **何をテストするか**: 画面に8-12個の状態ボタンが表示されること
  - **期待される動作**: 必須8個（痛い、トイレ、暑い、寒い、水、眠い、助けて、待って）が表示される
- **入力値**: なし（初期状態）
  - **入力データの意味**: デフォルト設定での表示確認
- **期待される結果**: 少なくとも8個の状態ボタンが表示される
  - **期待結果の理由**: REQ-203で8-12個と規定
- **テストの目的**: 状態ボタンの表示確認（REQ-202、REQ-203準拠）
  - **確認ポイント**: 必須ボタンがすべて表示される
- 🔵 信頼性レベル: 青信号 - REQ-202、REQ-203に基づく

### TC-E2E-084-007: 「痛い」ボタンタップで即座に読み上げが開始される

- **テスト名**: 「痛い」ボタン読み上げ開始確認
  - **何をテストするか**: 状態ボタンタップでTTS読み上げが開始されること
  - **期待される動作**: タップから1秒以内にTTS読み上げが開始される
- **入力値**: 「痛い」ボタンのタップ
  - **入力データの意味**: ユーザーの身体状態伝達
- **期待される結果**: 停止ボタンが表示される
  - **期待結果の理由**: REQ-204準拠
- **テストの目的**: 状態ボタン即座読み上げ確認（REQ-204準拠）
  - **確認ポイント**: 1秒以内の読み上げ開始
- 🔵 信頼性レベル: 青信号 - REQ-204に基づく

### TC-E2E-084-008: 「トイレ」ボタンタップで即座に読み上げが開始される

- **テスト名**: 「トイレ」ボタン読み上げ開始確認
  - **何をテストするか**: 「トイレ」ボタンタップでTTS読み上げが開始されること
  - **期待される動作**: タップから1秒以内にTTS読み上げが開始される
- **入力値**: 「トイレ」ボタンのタップ
  - **入力データの意味**: ユーザーの要求伝達
- **期待される結果**: 停止ボタンが表示される
  - **期待結果の理由**: REQ-204準拠
- **テストの目的**: 複数の状態ボタン動作確認
  - **確認ポイント**: すべての状態ボタンで一貫した動作
- 🔵 信頼性レベル: 青信号 - REQ-204に基づく

### TC-E2E-084-009: すべての必須状態ボタンが正しくタップできる

- **テスト名**: 必須8個の状態ボタン動作確認
  - **何をテストするか**: 必須の8個すべてが正常に動作すること
  - **期待される動作**: すべてのボタンでTTS読み上げが開始される
- **入力値**: 各状態ボタン（痛い、トイレ、暑い、寒い、水、眠い、助けて、待って）を順番にタップ
  - **入力データの意味**: 網羅的な機能確認
- **期待される結果**: 各ボタンタップでTTS読み上げが正常に開始される
  - **期待結果の理由**: REQ-202、REQ-204準拠
- **テストの目的**: 状態ボタン全体の動作確認
  - **確認ポイント**: 8個すべてが正常動作
- 🔵 信頼性レベル: 青信号 - REQ-202、REQ-204に基づく

---

## 3. 正常系テストケース（緊急ボタン）

### TC-E2E-084-010: 緊急ボタンが常時表示される

- **テスト名**: 緊急ボタン常時表示確認
  - **何をテストするか**: すべての画面で緊急ボタンが表示されること
  - **期待される動作**: ホーム、定型文、履歴、設定などの各画面で緊急ボタンが表示される
- **入力値**: 各画面への遷移
  - **入力データの意味**: 全画面での一貫性確認
- **期待される結果**: すべての画面で緊急ボタン（通知アイコン）が表示される
  - **期待結果の理由**: REQ-301で「すべての画面で常時表示」と規定
- **テストの目的**: 緊急ボタン常時表示確認（REQ-301準拠）
  - **確認ポイント**: 各画面での表示確認
- 🔵 信頼性レベル: 青信号 - REQ-301に基づく

### TC-E2E-084-011: 緊急ボタンタップで確認ダイアログが表示される

- **テスト名**: 緊急ボタン1段階目確認
  - **何をテストするか**: 緊急ボタンタップで確認ダイアログが表示されること
  - **期待される動作**: 「緊急呼び出しを実行しますか？」ダイアログが表示される
- **入力値**: 緊急ボタンのタップ
  - **入力データの意味**: 緊急呼び出しの開始
- **期待される結果**: 確認ダイアログが表示される
  - **期待結果の理由**: REQ-302で2段階確認を規定
- **テストの目的**: 2段階確認の1段階目確認（REQ-302準拠）
  - **確認ポイント**: ダイアログ表示、「はい」「いいえ」ボタンの存在
- 🔵 信頼性レベル: 青信号 - REQ-302に基づく

### TC-E2E-084-012: 確認ダイアログで「いいえ」選択でキャンセル

- **テスト名**: 緊急呼び出しキャンセル確認
  - **何をテストするか**: 確認ダイアログで「いいえ」選択すると緊急処理がキャンセルされること
  - **期待される動作**: ダイアログが閉じ、通常画面が維持される
- **入力値**: 緊急ボタンタップ → 確認ダイアログ「いいえ」
  - **入力データの意味**: 誤操作のキャンセル
- **期待される結果**: ダイアログが閉じ、緊急画面は表示されない
  - **期待結果の理由**: REQ-5002（誤操作防止）準拠
- **テストの目的**: 誤操作防止機能確認（REQ-5002準拠）
  - **確認ポイント**: 通常画面が維持される
- 🔵 信頼性レベル: 青信号 - REQ-302、REQ-5002に基づく

### TC-E2E-084-013: 確認ダイアログで「はい」選択で緊急処理実行

- **テスト名**: 緊急呼び出し実行確認
  - **何をテストするか**: 確認ダイアログで「はい」選択すると緊急処理が実行されること
  - **期待される動作**: 緊急音が再生され、画面が赤色の緊急画面に切り替わる
- **入力値**: 緊急ボタンタップ → 確認ダイアログ「はい」
  - **入力データの意味**: 緊急呼び出しの確定
- **期待される結果**:
  - 緊急画面（赤い全画面）が表示される
  - 「緊急呼び出し中」メッセージが表示される
  - リセットボタンが表示される
  - **期待結果の理由**: REQ-303（緊急音）、REQ-304（画面赤表示）準拠
- **テストの目的**: 緊急処理実行確認（REQ-303、REQ-304準拠）
  - **確認ポイント**: 緊急画面への遷移
- 🔵 信頼性レベル: 青信号 - REQ-303、REQ-304に基づく

### TC-E2E-084-014: 緊急画面でリセットボタンタップで通常画面に戻る

- **テスト名**: 緊急状態リセット確認
  - **何をテストするか**: リセットボタンタップで緊急状態が解除されること
  - **期待される動作**: 通常画面（ホーム画面）に戻る
- **入力値**: 緊急画面のリセットボタンタップ
  - **入力データの意味**: 緊急状態の解除
- **期待される結果**:
  - 緊急画面が消える
  - 通常画面（ホーム画面）に戻る
  - **期待結果の理由**: FR-008（リセット機能）準拠
- **テストの目的**: リセット機能確認
  - **確認ポイント**: 緊急状態の完全解除
- 🔵 信頼性レベル: 青信号 - 実装（EmergencyAlertScreen）に基づく

---

## 4. 異常系テストケース

### TC-E2E-084-015: 大ボタンを空の入力欄状態でタップしても安全に処理される

- **テスト名**: 大ボタン安全性確認
  - **エラーケースの概要**: 入力欄が空の状態での大ボタンタップ
  - **エラー処理の重要性**: アプリのクラッシュ防止
- **入力値**: 入力欄が空の状態で「はい」ボタンをタップ
  - **不正な理由**: 入力欄が空でも大ボタンは動作すべき
  - **実際の発生シナリオ**: 初回起動直後の操作
- **期待される結果**: アプリがクラッシュせず、TTS読み上げが正常に開始される
  - **エラーメッセージの内容**: なし（正常動作）
  - **システムの安全性**: 大ボタンは入力欄とは独立して動作
- **テストの目的**: 大ボタンの安全性確認
  - **品質保証の観点**: 堅牢性の確認
- 🟡 信頼性レベル: 黄信号 - NFR-301（安定性）から推測

### TC-E2E-084-016: 緊急ボタン誤操作防止（2段階確認）が正しく機能する

- **テスト名**: 緊急ボタン誤操作防止確認
  - **エラーケースの概要**: 誤って緊急ボタンをタップした場合のキャンセル
  - **エラー処理の重要性**: 誤アラートの防止
- **入力値**: 緊急ボタンタップ → 確認ダイアログ「いいえ」
  - **不正な理由**: 誤操作のシミュレーション
  - **実際の発生シナリオ**: ボタンに誤ってタッチした場合
- **期待される結果**: 緊急処理が実行されず、通常画面が維持される
  - **エラーメッセージの内容**: なし（キャンセル成功）
  - **システムの安全性**: 2段階確認により誤操作を防止
- **テストの目的**: 誤操作防止機能確認（REQ-5002準拠）
  - **品質保証の観点**: ユーザー体験の向上
- 🔵 信頼性レベル: 青信号 - REQ-302、REQ-5002に基づく

### TC-E2E-084-017: 確認ダイアログ外タップで閉じない

- **テスト名**: 確認ダイアログ誤操作防止確認
  - **エラーケースの概要**: 確認ダイアログ外をタップしても閉じないこと
  - **エラー処理の重要性**: 意図しないダイアログ閉鎖の防止
- **入力値**: 緊急ボタンタップ → ダイアログ外をタップ
  - **不正な理由**: 誤タップのシミュレーション
  - **実際の発生シナリオ**: 震える手でタップした場合
- **期待される結果**: ダイアログが閉じない（barrierDismissible: false）
  - **エラーメッセージの内容**: なし
  - **システムの安全性**: 意図的な選択のみを受け付ける
- **テストの目的**: ダイアログの誤操作防止確認
  - **品質保証の観点**: アクセシビリティ対応
- 🔵 信頼性レベル: 青信号 - 実装（barrierDismissible: false）に基づく

---

## 5. パフォーマンステストケース

### TC-E2E-084-018: 大ボタンタップから読み上げ開始まで1秒以内

- **テスト名**: 大ボタン読み上げパフォーマンス確認
  - **境界値の意味**: NFR-001で規定された1秒以内の要件
  - **境界値での動作保証**: TTS読み上げ開始が1000ms以内
- **入力値**: 「はい」ボタンのタップ
  - **境界値選択の根拠**: NFR-001の要件
  - **実際の使用場面**: 質問への即座応答
- **期待される結果**: 停止ボタン表示まで1000ms以内
  - **境界での正確性**: 1001ms以上で失敗
  - **一貫した動作**: 複数回の計測で安定
- **テストの目的**: パフォーマンス要件確認（NFR-001準拠）
  - **堅牢性の確認**: 安定したレスポンス時間
- 🔵 信頼性レベル: 青信号 - NFR-001に基づく

### TC-E2E-084-019: 状態ボタンタップから読み上げ開始まで1秒以内

- **テスト名**: 状態ボタン読み上げパフォーマンス確認
  - **境界値の意味**: NFR-001で規定された1秒以内の要件
  - **境界値での動作保証**: TTS読み上げ開始が1000ms以内
- **入力値**: 「痛い」ボタンのタップ
  - **境界値選択の根拠**: NFR-001の要件
  - **実際の使用場面**: 緊急の身体状態伝達
- **期待される結果**: 停止ボタン表示まで1000ms以内
  - **境界での正確性**: 1001ms以上で失敗
  - **一貫した動作**: 複数回の計測で安定
- **テストの目的**: パフォーマンス要件確認（NFR-001準拠）
  - **堅牢性の確認**: 安定したレスポンス時間
- 🔵 信頼性レベル: 青信号 - NFR-001に基づく

---

## 6. 統合テストケース

### TC-E2E-084-020: 大ボタンタップ→読み上げ→履歴保存の一連フロー

- **テスト名**: 大ボタン統合フロー確認
  - **何をテストするか**: 大ボタンからの読み上げが履歴に保存されること
  - **期待される動作**: 「はい」ボタンタップ→読み上げ→履歴に保存
- **入力値**: 「はい」ボタンタップ → 読み上げ後に履歴画面へ遷移
  - **入力データの意味**: 完全なユーザーフロー
- **期待される結果**: 履歴画面に「はい」が保存されている
  - **期待結果の理由**: 読み上げ内容は履歴に保存される設計
- **テストの目的**: 大ボタン機能の統合確認
  - **確認ポイント**: データの一貫性
- 🟡 信頼性レベル: 黄信号 - 履歴保存機能との連携から推測

### TC-E2E-084-021: 緊急ボタン→確認→緊急画面→リセットの一連フロー

- **テスト名**: 緊急機能統合フロー確認
  - **何をテストするか**: 緊急呼び出しからリセットまでの完全フロー
  - **期待される動作**: 緊急ボタン→確認→緊急画面→リセット→通常画面
- **入力値**: 緊急ボタンタップ → 「はい」 → リセットボタンタップ
  - **入力データの意味**: 完全な緊急フロー
- **期待される結果**:
  - 確認ダイアログ表示
  - 緊急画面表示（赤い全画面）
  - リセット後に通常画面に戻る
  - **期待結果の理由**: REQ-302〜REQ-304の統合確認
- **テストの目的**: 緊急機能の統合確認
  - **確認ポイント**: 各段階の正常動作
- 🔵 信頼性レベル: 青信号 - REQ-302〜REQ-304に基づく

---

## テストケースサマリー

| カテゴリ | テストケース数 | 信頼性レベル |
|---------|---------------|-------------|
| 正常系（大ボタン） | 5 | 🔵 青信号 4件、🟡 黄信号 1件 |
| 正常系（状態ボタン） | 4 | 🔵 青信号 4件 |
| 正常系（緊急ボタン） | 5 | 🔵 青信号 5件 |
| 異常系 | 3 | 🔵 青信号 2件、🟡 黄信号 1件 |
| パフォーマンス | 2 | 🔵 青信号 2件 |
| 統合テスト | 2 | 🔵 青信号 1件、🟡 黄信号 1件 |
| **合計** | **21** | **🔵 18件、🟡 3件** |

---

## 品質判定

✅ **高品質**

- **テストケース分類**: 正常系・異常系・境界値（パフォーマンス）が網羅されている
- **期待値定義**: 各テストケースの期待値が明確
- **技術選択**: Dart + integration_test（Flutter公式）で確定
- **実装可能性**: 既存E2Eテスト（TASK-0082, TASK-0083）と同一構成で実現可能

---

## 次のステップ

次のお勧めステップ: `/tsumiki:tdd-red` でRedフェーズ（失敗テスト作成）を開始します。

---

## 更新履歴

- **2025-11-29**: テストケース一覧作成（TASK-0084）
