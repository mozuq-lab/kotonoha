# TASK-0078: エラーUI・エラーメッセージ実装 - 要件定義

## タスク概要

- **タスクID**: TASK-0078
- **タスク名**: エラーUI・エラーメッセージ実装
- **関連要件**: NFR-204, EDGE-001, EDGE-002, EDGE-004
- **依存タスク**: TASK-0076, TASK-0077

## 関連要件（EARS記法）

### NFR-204: 分かりやすい日本語エラーメッセージ 🔵

**EARS記法**: Ubiquitous
> システムのエラーメッセージは分かりやすい日本語で表示されなければならない

**受け入れ基準**:
- すべてのエラーメッセージが日本語で表示される
- 英語のエラーメッセージが含まれない
- エラーメッセージが一元管理される（ErrorMessagesクラス）

### EDGE-001: ネットワークエラー時の再試行オプション 🔵

**EARS記法**: Event-driven
> ユーザーがネットワークエラーに遭遇した場合、システムは再試行オプションを提供しなければならない

**受け入れ基準**:
- ネットワークエラーダイアログに「再試行」ボタンが表示される
- wifi_offアイコンが表示される
- 「インターネットに接続できませんでした」メッセージが表示される
- キャンセルボタンで操作を中止できる

### EDGE-002: AI変換エラー時のフォールバック 🔵

**EARS記法**: Event-driven
> ユーザーがAI変換エラーに遭遇した場合、システムは元のテキストを使用するフォールバックを提供しなければならない

**受け入れ基準**:
- AI変換エラーダイアログに「元のテキストを使用」ボタンが表示される
- 元のテキストがプレビュー表示される
- 再試行ボタン（オプション）が提供される

### EDGE-004: TTS再生エラー時のメッセージ 🔵

**EARS記法**: Event-driven
> ユーザーがTTS再生エラーに遭遇した場合、システムはテキスト表示で継続可能であることを通知しなければならない

**受け入れ基準**:
- volume_offアイコンが表示される
- 「テキストは画面に表示されています」メッセージが表示される
- 端末設定確認の案内が表示される

## 機能要件

### 1. 汎用エラーダイアログ (showErrorDialog)

| 要件ID | 説明 | 優先度 |
|--------|------|--------|
| ERR-001 | タイトルとメッセージを表示する | 高 |
| ERR-002 | アイコンを表示する（オプション） | 中 |
| ERR-003 | OKボタンで閉じられる | 高 |
| ERR-004 | 再試行ボタンを表示できる（オプション） | 高 |
| ERR-005 | 再試行コールバックを呼び出せる | 高 |

### 2. エラースナックバー (showErrorSnackBar)

| 要件ID | 説明 | 優先度 |
|--------|------|--------|
| SB-001 | 画面下部にエラーメッセージを表示する | 高 |
| SB-002 | 再試行ボタンを表示できる（オプション） | 中 |
| SB-003 | 一定時間後に自動で非表示になる | 高 |
| SB-004 | 表示時間をカスタマイズできる | 低 |

### 3. ネットワークエラーダイアログ (showNetworkErrorDialog)

| 要件ID | 説明 | 優先度 |
|--------|------|--------|
| NET-001 | wifi_offアイコンを表示する | 中 |
| NET-002 | 「インターネットに接続できませんでした」メッセージを表示する | 高 |
| NET-003 | 再試行ボタンを表示する | 高 |
| NET-004 | キャンセルボタンを表示する | 高 |
| NET-005 | 再試行コールバックを呼び出せる | 高 |

### 4. AI変換エラーダイアログ (showAIConversionErrorDialog)

| 要件ID | 説明 | 優先度 |
|--------|------|--------|
| AI-001 | 元のテキストをプレビュー表示する | 高 |
| AI-002 | 「元のテキストを使用」ボタンを表示する | 高 |
| AI-003 | 再試行ボタンを表示できる（オプション） | 中 |
| AI-004 | 元のテキスト使用コールバックを呼び出せる | 高 |

### 5. TTS再生エラーダイアログ (showTTSErrorDialog)

| 要件ID | 説明 | 優先度 |
|--------|------|--------|
| TTS-001 | volume_offアイコンを表示する | 中 |
| TTS-002 | 「テキストは画面に表示されています」メッセージを表示する | 高 |
| TTS-003 | 端末設定確認の案内を表示する | 高 |
| TTS-004 | OKボタンで閉じられる | 高 |

### 6. エラーメッセージ定数クラス (ErrorMessages)

| 要件ID | 説明 | 優先度 |
|--------|------|--------|
| MSG-001 | ネットワークエラーメッセージを定義する | 高 |
| MSG-002 | タイムアウトエラーメッセージを定義する | 高 |
| MSG-003 | サーバーエラーメッセージを定義する | 高 |
| MSG-004 | AI変換エラーメッセージを定義する | 高 |
| MSG-005 | TTS再生エラーメッセージを定義する | 高 |
| MSG-006 | 保存エラーメッセージを定義する | 高 |
| MSG-007 | 読み込みエラーメッセージを定義する | 高 |

## 非機能要件

| 要件ID | 説明 | 基準値 |
|--------|------|--------|
| NFR-ERR-001 | ダイアログ表示 | 100ms以内 |
| NFR-ERR-002 | スナックバー自動非表示 | 4秒（デフォルト） |
| NFR-ERR-003 | アクセシビリティ | スクリーンリーダー対応 |

## 信頼性レベル

- 🔵 **青信号**: NFR-204, EDGE-001, EDGE-002, EDGE-004 - EARS要件定義書に明記
