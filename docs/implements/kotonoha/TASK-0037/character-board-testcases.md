# TDDテストケース: 五十音文字盤UI

## タスク情報

- **タスクID**: TASK-0037
- **機能名**: 五十音文字盤UI実装
- **作成日**: 2025-11-22
- **テストファイル**: `test/features/character_board/presentation/widgets/character_board_widget_test.dart`

---

## 開発言語・テストフレームワーク

- **プログラミング言語**: Dart 3.10+
  - **言語選択の理由**: Flutterの標準言語、既存プロジェクトとの一貫性
  - **テストに適した機能**: Null Safety、強力な型システム
- **テストフレームワーク**: flutter_test
  - **フレームワーク選択の理由**: Flutter公式、Widget テストのサポート
  - **テスト実行環境**: `flutter test` コマンド
- 🔵 青信号（tech-stack.mdに明記）

---

## テストケース一覧

### 1. 正常系テストケース（基本動作）

#### TC-CB-001: 基本五十音が正しく表示される 🔵

- **テスト名**: 基本五十音が正しく表示される
  - **何をテストするか**: 五十音文字盤の基本ひらがな表示
  - **期待される動作**: あ〜んの基本46文字が表示される
- **入力値**: デフォルト（カテゴリ: 基本）
  - **入力データの意味**: 初期状態での文字盤表示
- **期待される結果**: 「あ」「い」「う」...「ん」が表示される
  - **期待結果の理由**: REQ-001で五十音配列の文字盤表示が必須
- **テストの目的**: REQ-001の充足確認
  - **確認ポイント**: 基本ひらがなの網羅性

#### TC-CB-002: 濁音が正しく表示される 🔵

- **テスト名**: 濁音が正しく表示される
  - **何をテストするか**: 濁音（が行、ざ行など）の表示
  - **期待される動作**: 20文字の濁音が表示される
- **入力値**: カテゴリ切り替え（濁音）
  - **入力データの意味**: 濁音カテゴリの選択
- **期待される結果**: 「が」「ぎ」「ぐ」...「ぼ」が表示される
  - **期待結果の理由**: 日本語入力に濁音は必須
- **テストの目的**: 濁音文字の網羅性確認
  - **確認ポイント**: 濁音20文字すべて

#### TC-CB-003: 半濁音が正しく表示される 🔵

- **テスト名**: 半濁音が正しく表示される
  - **何をテストするか**: 半濁音（ぱ行）の表示
  - **期待される動作**: 5文字の半濁音が表示される
- **入力値**: カテゴリ切り替え（半濁音）
  - **入力データの意味**: 半濁音カテゴリの選択
- **期待される結果**: 「ぱ」「ぴ」「ぷ」「ぺ」「ぽ」が表示される
  - **期待結果の理由**: 日本語入力に半濁音は必須
- **テストの目的**: 半濁音文字の網羅性確認
  - **確認ポイント**: 半濁音5文字すべて

#### TC-CB-004: 拗音・小文字が正しく表示される 🔵

- **テスト名**: 拗音・小文字が正しく表示される
  - **何をテストするか**: 小文字（ゃゅょ、ぁぃぅぇぉ、っ）の表示
  - **期待される動作**: 9文字の小文字が表示される
- **入力値**: カテゴリ切り替え（小文字）
  - **入力データの意味**: 小文字カテゴリの選択
- **期待される結果**: 「ゃ」「ゅ」「ょ」「ぁ」「ぃ」「ぅ」「ぇ」「ぉ」「っ」が表示される
  - **期待結果の理由**: 日本語入力に拗音・促音は必須
- **テストの目的**: 拗音・小文字の網羅性確認
  - **確認ポイント**: 小文字9文字すべて

#### TC-CB-005: 句読点・記号が正しく表示される 🟡

- **テスト名**: 句読点・記号が正しく表示される
  - **何をテストするか**: 句読点と記号の表示
  - **期待される動作**: 5文字の記号が表示される
- **入力値**: カテゴリ切り替え（記号）または基本画面
  - **入力データの意味**: 記号カテゴリの選択
- **期待される結果**: 「ー」「、」「。」「？」「！」が表示される
  - **期待結果の理由**: 文章作成に句読点は必須
- **テストの目的**: 記号の網羅性確認
  - **確認ポイント**: 記号5文字すべて

#### TC-CB-006: 文字タップでコールバックが呼ばれる 🔵

- **テスト名**: 文字タップでコールバックが呼ばれる
  - **何をテストするか**: 文字ボタンタップ時のコールバック呼び出し
  - **期待される動作**: タップした文字がコールバックに渡される
- **入力値**: 「あ」ボタンをタップ
  - **入力データの意味**: 基本的な文字入力操作
- **期待される結果**: onCharacterTap('あ') が呼ばれる
  - **期待結果の理由**: REQ-002でタップで文字追加が必須
- **テストの目的**: REQ-002の充足確認
  - **確認ポイント**: コールバック引数が正しい文字

#### TC-CB-007: 連続タップで複数文字が入力される 🔵

- **テスト名**: 連続タップで複数文字が入力される
  - **何をテストするか**: 連続した文字タップ
  - **期待される動作**: 各タップごとにコールバックが呼ばれる
- **入力値**: 「こ」「ん」「に」「ち」「は」を順番にタップ
  - **入力データの意味**: 実際の使用シナリオ
- **期待される結果**: 5回のコールバックが順番に呼ばれる
  - **期待結果の理由**: UC-002に基づく連続入力
- **テストの目的**: 連続入力の動作確認
  - **確認ポイント**: 各コールバックの呼び出し順序

---

### 2. サイズ・レイアウトテストケース

#### TC-CB-008: ボタンサイズが44px以上である 🔵

- **テスト名**: ボタンサイズが44px以上である
  - **何をテストするか**: タップターゲットの最小サイズ
  - **期待される動作**: 各文字ボタンが44px × 44px以上
- **入力値**: デフォルト設定
  - **入力データの意味**: 最低限のアクセシビリティ確保
- **期待される結果**: width >= 44.0, height >= 44.0
  - **期待結果の理由**: REQ-5001でタップターゲット44px以上が必須
- **テストの目的**: REQ-5001の充足確認
  - **確認ポイント**: 全ボタンのサイズ

#### TC-CB-009: 推奨ボタンサイズが60px以上である 🟡

- **テスト名**: 推奨ボタンサイズが60px以上である
  - **何をテストするか**: タップターゲットの推奨サイズ
  - **期待される動作**: 各文字ボタンが60px × 60px以上
- **入力値**: デフォルト設定
  - **入力データの意味**: 推奨アクセシビリティサイズ
- **期待される結果**: width >= 60.0, height >= 60.0
  - **期待結果の理由**: NFR-202で推奨60px以上
- **テストの目的**: NFR-202の充足確認
  - **確認ポイント**: デフォルト状態のボタンサイズ

#### TC-CB-010: 縦向きレイアウトで正しく表示される 🟡

- **テスト名**: 縦向きレイアウトで正しく表示される
  - **何をテストするか**: Portrait モードでのレイアウト
  - **期待される動作**: 縦向き画面で文字盤が適切に配置される
- **入力値**: MediaQuery.of(context).orientation = portrait
  - **入力データの意味**: タブレット縦向き使用時
- **期待される結果**: オーバーフローなく表示される
  - **期待結果の理由**: NFR-403で縦横両対応が必須
- **テストの目的**: NFR-403の充足確認
  - **確認ポイント**: レイアウトオーバーフローなし

#### TC-CB-011: 横向きレイアウトで正しく表示される 🟡

- **テスト名**: 横向きレイアウトで正しく表示される
  - **何をテストするか**: Landscape モードでのレイアウト
  - **期待される動作**: 横向き画面で文字盤が適切に配置される
- **入力値**: MediaQuery.of(context).orientation = landscape
  - **入力データの意味**: タブレット横向き使用時
- **期待される結果**: オーバーフローなく表示される
  - **期待結果の理由**: NFR-403で縦横両対応が必須
- **テストの目的**: NFR-403の充足確認
  - **確認ポイント**: レイアウトオーバーフローなし

---

### 3. テーマ・スタイルテストケース

#### TC-CB-012: ライトテーマで適切な色が使用される 🔵

- **テスト名**: ライトテーマで適切な色が使用される
  - **何をテストするか**: ライトモードでの配色
  - **期待される動作**: ライトテーマの配色が適用される
- **入力値**: theme: lightTheme
  - **入力データの意味**: デフォルトのライトモード
- **期待される結果**: ライトテーマのカラースキームが適用される
  - **期待結果の理由**: REQ-803でテーマ対応が必須
- **テストの目的**: REQ-803の充足確認
  - **確認ポイント**: Theme.of(context).brightness == light

#### TC-CB-013: ダークテーマで適切な色が使用される 🔵

- **テスト名**: ダークテーマで適切な色が使用される
  - **何をテストするか**: ダークモードでの配色
  - **期待される動作**: ダークテーマの配色が適用される
- **入力値**: theme: darkTheme
  - **入力データの意味**: ダークモード設定時
- **期待される結果**: ダークテーマのカラースキームが適用される
  - **期待結果の理由**: REQ-803でテーマ対応が必須
- **テストの目的**: REQ-803の充足確認
  - **確認ポイント**: Theme.of(context).brightness == dark

#### TC-CB-014: 高コントラストテーマで適切な色が使用される 🔵

- **テスト名**: 高コントラストテーマで適切な色が使用される
  - **何をテストするか**: 高コントラストモードでの配色
  - **期待される動作**: 高コントラストテーマの配色が適用される
- **入力値**: theme: highContrastTheme
  - **入力データの意味**: 高コントラストモード設定時
- **期待される結果**: 高コントラストのカラースキームが適用される
  - **期待結果の理由**: REQ-803, REQ-5006でWCAG AA準拠が必須
- **テストの目的**: REQ-803, REQ-5006の充足確認
  - **確認ポイント**: コントラスト比4.5:1以上

#### TC-CB-015: フォントサイズ「小」で適切なサイズになる 🔵

- **テスト名**: フォントサイズ「小」で適切なサイズになる
  - **何をテストするか**: フォントサイズ設定の追従
  - **期待される動作**: 文字盤の文字が小サイズで表示される
- **入力値**: fontSize: FontSize.small
  - **入力データの意味**: フォントサイズ設定「小」
- **期待される結果**: 文字サイズが16.0（AppSizes.fontSizeSmall）
  - **期待結果の理由**: REQ-801, REQ-802でフォントサイズ追従が必須
- **テストの目的**: REQ-801, REQ-802の充足確認
  - **確認ポイント**: Text widgetのfontSize

#### TC-CB-016: フォントサイズ「中」で適切なサイズになる 🔵

- **テスト名**: フォントサイズ「中」で適切なサイズになる
  - **何をテストするか**: フォントサイズ設定の追従
  - **期待される動作**: 文字盤の文字が中サイズで表示される
- **入力値**: fontSize: FontSize.medium
  - **入力データの意味**: フォントサイズ設定「中」（デフォルト）
- **期待される結果**: 文字サイズが20.0（AppSizes.fontSizeMedium）
  - **期待結果の理由**: REQ-801, REQ-802でフォントサイズ追従が必須
- **テストの目的**: REQ-801, REQ-802の充足確認
  - **確認ポイント**: Text widgetのfontSize

#### TC-CB-017: フォントサイズ「大」で適切なサイズになる 🔵

- **テスト名**: フォントサイズ「大」で適切なサイズになる
  - **何をテストするか**: フォントサイズ設定の追従
  - **期待される動作**: 文字盤の文字が大サイズで表示される
- **入力値**: fontSize: FontSize.large
  - **入力データの意味**: フォントサイズ設定「大」
- **期待される結果**: 文字サイズが24.0（AppSizes.fontSizeLarge）
  - **期待結果の理由**: REQ-801, REQ-802でフォントサイズ追従が必須
- **テストの目的**: REQ-801, REQ-802の充足確認
  - **確認ポイント**: Text widgetのfontSize

---

### 4. アクセシビリティテストケース

#### TC-CB-018: Semanticsラベルが設定される 🔵

- **テスト名**: Semanticsラベルが設定される
  - **何をテストするか**: スクリーンリーダー対応
  - **期待される動作**: 各文字ボタンにSemanticsラベルが設定される
- **入力値**: デフォルト設定
  - **入力データの意味**: アクセシビリティ要件
- **期待される結果**: Semantics(label: 'あ') などが設定される
  - **期待結果の理由**: アクセシビリティ標準
- **テストの目的**: アクセシビリティ要件の充足確認
  - **確認ポイント**: Semantics widgetの存在

#### TC-CB-019: タップフィードバックが表示される 🟡

- **テスト名**: タップフィードバックが表示される
  - **何をテストするか**: 視覚的フィードバック
  - **期待される動作**: タップ時にアニメーションが表示される
- **入力値**: 文字ボタンをタップ
  - **入力データの意味**: ユーザーへのフィードバック
- **期待される結果**: InkWell/InkResponseによるリップルエフェクト
  - **期待結果の理由**: UC-001で視覚的フィードバックが必要
- **テストの目的**: ユーザビリティ確認
  - **確認ポイント**: InkWell widgetの存在

---

### 5. 状態テストケース

#### TC-CB-020: isEnabled: falseで無効状態になる 🟡

- **テスト名**: isEnabled: falseで無効状態になる
  - **何をテストするか**: 無効状態の制御
  - **期待される動作**: 文字盤全体が無効化される
- **入力値**: isEnabled: false
  - **入力データの意味**: 入力禁止状態
- **期待される結果**: タップしてもコールバックが呼ばれない
  - **期待結果の理由**: 状態管理の必要性
- **テストの目的**: 状態制御の確認
  - **確認ポイント**: onCharacterTapが呼ばれない

#### TC-CB-021: isEnabled: trueで有効状態になる 🟡

- **テスト名**: isEnabled: trueで有効状態になる
  - **何をテストするか**: 有効状態の制御
  - **期待される動作**: 文字盤が有効化される
- **入力値**: isEnabled: true（デフォルト）
  - **入力データの意味**: 通常の入力可能状態
- **期待される結果**: タップでコールバックが呼ばれる
  - **期待結果の理由**: デフォルト動作
- **テストの目的**: 状態制御の確認
  - **確認ポイント**: onCharacterTapが呼ばれる

---

### 6. 異常系テストケース

#### TC-CB-022: onCharacterTapがnullでもクラッシュしない 🟡

- **テスト名**: onCharacterTapがnullでもクラッシュしない
  - **エラーケースの概要**: コールバック未設定時の動作
  - **エラー処理の重要性**: 設定ミス時のアプリクラッシュ防止
- **入力値**: onCharacterTap: null（または省略）
  - **不正な理由**: 必須パラメータが欠落
  - **実際の発生シナリオ**: 開発中のミス
- **期待される結果**: コンパイルエラーまたは安全に無視
  - **エラーメッセージの内容**: なし（型システムで防止）
  - **システムの安全性**: クラッシュしない
- **テストの目的**: 堅牢性の確認
  - **品質保証の観点**: 型安全性の確認
- 🔴 赤信号（推測による追加テスト）

---

### 7. 境界値テストケース

#### TC-CB-023: 最小画面サイズでも表示される 🟡

- **テスト名**: 最小画面サイズでも表示される
  - **境界値の意味**: サポート最小画面での動作
  - **境界値での動作保証**: スマートフォンでも基本動作
- **入力値**: width: 320, height: 480
  - **境界値選択の根拠**: 一般的な小型スマートフォン
  - **実際の使用場面**: スマートフォンでの緊急使用
- **期待される結果**: オーバーフローなく表示される
  - **境界での正確性**: 全文字が表示される
  - **一貫した動作**: タップ機能が動作する
- **テストの目的**: 最小画面対応の確認
  - **堅牢性の確認**: 様々な端末での動作保証
- 🟡 黄信号（NFR-402から推測）

#### TC-CB-024: 大画面タブレットで適切にレイアウトされる 🟡

- **テスト名**: 大画面タブレットで適切にレイアウトされる
  - **境界値の意味**: サポート最大画面での動作
  - **境界値での動作保証**: 大画面タブレットでの最適表示
- **入力値**: width: 1024, height: 768
  - **境界値選択の根拠**: 一般的なタブレットサイズ
  - **実際の使用場面**: 主要対象デバイス
- **期待される結果**: 適切なサイズとスペーシングで表示
  - **境界での正確性**: ボタンサイズが適切
  - **一貫した動作**: 見やすく操作しやすい
- **テストの目的**: タブレット最適化の確認
  - **堅牢性の確認**: 主要対象デバイスでの品質
- 🟡 黄信号（NFR-402から推測）

---

## テストケースサマリー

| カテゴリ | テストケース数 | 信頼性レベル |
|---------|--------------|-------------|
| 正常系（基本動作） | 7 | 🔵 6, 🟡 1 |
| サイズ・レイアウト | 4 | 🔵 1, 🟡 3 |
| テーマ・スタイル | 6 | 🔵 6 |
| アクセシビリティ | 2 | 🔵 1, 🟡 1 |
| 状態 | 2 | 🟡 2 |
| 異常系 | 1 | 🔴 1 |
| 境界値 | 2 | 🟡 2 |
| **合計** | **24** | 🔵 14, 🟡 9, 🔴 1 |

---

## 品質判定

```
✅ 高品質:
- テストケース分類: 正常系・異常系・境界値が網羅されている
- 期待値定義: 各テストケースの期待値が明確
- 技術選択: Dart / flutter_test が確定
- 実装可能性: Flutter標準機能で実現可能
- 信頼性: 24テストケース中14件が青信号（58%）
```

---

## 参照ドキュメント

- **要件定義書**: `docs/implements/kotonoha/TASK-0037/character-board-requirements.md`
- **既存テストパターン**: `test/shared/widgets/large_button_test.dart`
- **EARS要件**: `docs/spec/kotonoha-requirements.md`

---

**次のお勧めステップ**: `/tsumiki:tdd-red` でRedフェーズ（失敗テスト作成）を開始します。
